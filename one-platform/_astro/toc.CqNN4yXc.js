import{a as b,j as o}from"./app.utils.DGnWvfXt.js";import{r as c}from"./index.Cd_vQiNd.js";function O(u){const{headings:l=[]}=u,h=l.map(e=>e.slug),f=b(u.astro),r=c.useRef(null),[x,i]=c.useState(""),a=c.useRef(new Set),m="on-this-page-heading";c.useEffect(()=>{if(!r.current)return;const e=d=>{for(const p of d){const{id:s}=p.target;s!==m&&(p.isIntersecting?a.current.add(s):a.current.delete(s),v(s))}},t={root:null,rootMargin:"-96px 0px 0px 0px",threshold:1},n=new IntersectionObserver(e,t);return document.querySelectorAll("h2[id], h3[id], h4[id], h5[id], h6[id]").forEach(d=>n.observe(d)),()=>n.disconnect()},[r.current]);const v=e=>{if(!r.current)return;const t=[...a.current].sort((n,g)=>h.indexOf(n)-h.indexOf(g));if(t.length>0)return i(t[0]);i(e)},I=e=>{e.preventDefault();const t=e.target.getAttribute("href").split("#")[1],n=`#${t}`;history?.pushState(null,"",`${f}${n}`),document.querySelector(n)?.scrollIntoView(),setTimeout(()=>i(t),100)};return o.jsx("aside",{className:"dba-toc",children:o.jsx("ul",{ref:r,children:l.map(({depth:e,slug:t,text:n})=>o.jsx("li",{className:"dba-toc-heading","data-depth":e,"data-slug":t,"data-active":x===t,children:o.jsx("a",{href:`${f}#${t}`,onClick:I,children:n})},t))})})}export{O as TableOfContents};
