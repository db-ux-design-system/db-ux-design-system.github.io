import{j as A,g as Ht}from"./app.utils.DGnWvfXt.js";import{r as d}from"./index.Cd_vQiNd.js";import{f as C,g as z,c as M,a as k,u as Q,d as J,b as j,D as K,i as Yt,s as ye,e as De,h as je,j as pe,k as Ge,l as qt,m as se,n as Jt,o as Kt,p as Xt,q as Zt}from"./navigation.utils.Cnp_pyM-.js";/* empty css                       */const Qt="OVERWRITE_DEFAULT_ID",Et="LABEL SHOULD BE SET",en=" ",He="-message",Ye="-valid-message",qe="-invalid-message",Je="-datalist",Ke="TODO: Add a validMessage",Ie="TODO: Add an invalidMessage",tn="Back",_t="Expand",Nt="Collapse",nn="BurgerMenu",on="brand",an="Close";var Ae;(function(e){e.FUNCTIONAL="functional",e.REGULAR="regular",e.EXPRESSIVE="expressive"})(Ae||(Ae={}));Object.entries(Ae).map(([,e])=>e);var Pe;(function(e){e.PRIMARY="primary"})(Pe||(Pe={}));var Oe;(function(e){e.NEUTRAL_BG_LEVEL_1="neutral-bg-basic-level-1",e.NEUTRAL_BG_LEVEL_2="neutral-bg-basic-level-2",e.NEUTRAL_BG_LEVEL_3="neutral-bg-basic-level-3",e.NEUTRAL_BG_TRANSPARENT_SEMI="neutral-bg-basic-transparent-semi",e.NEUTRAL_BG_TRANSPARENT_FULL="neutral-bg-basic-transparent-full",e.BRAND_BG_LEVEL_1="brand-bg-basic-level-1",e.BRAND_BG_LEVEL_2="brand-bg-basic-level-2",e.BRAND_BG_LEVEL_3="brand-bg-basic-level-3",e.BRAND_BG_TRANSPARENT_SEMI="brand-bg-basic-transparent-semi",e.BRAND_BG_TRANSPARENT_FULL="brand-bg-basic-transparent-full",e.SUCCESSFUL_BG_LEVEL_1="successful-bg-basic-level-1",e.SUCCESSFUL_BG_LEVEL_2="successful-bg-basic-level-2",e.SUCCESSFUL_BG_LEVEL_3="successful-bg-basic-level-3",e.SUCCESSFUL_BG_TRANSPARENT_SEMI="successful-bg-basic-transparent-semi",e.SUCCESSFUL_BG_TRANSPARENT_FULL="successful-bg-basic-transparent-full",e.CRITICAL_BG_LEVEL_1="critical-bg-basic-level-1",e.CRITICAL_BG_LEVEL_2="critical-bg-basic-level-2",e.CRITICAL_BG_LEVEL_3="critical-bg-basic-level-3",e.CRITICAL_BG_TRANSPARENT_SEMI="critical-bg-basic-transparent-semi",e.CRITICAL_BG_TRANSPARENT_Full="critical-bg-basic-transparent-full",e.WARNING_BG_LEVEL_1="warning-bg-basic-level-1",e.WARNING_BG_LEVEL_2="warning-bg-basic-level-2",e.WARNING_BG_LEVEL_3="warning-bg-basic-level-3",e.WARNING_BG_TRANSPARENT_SEMI="warning-bg-basic-transparent-semi",e.WARNING_BG_TRANSPARENT_FULL="warning-bg-basic-transparent-full",e.INFORMATIONAL_BG_LEVEL_1="informational-bg-basic-level-1",e.INFORMATIONAL_BG_LEVEL_2="informational-bg-basic-level-2",e.INFORMATIONAL_BG_LEVEL_3="informational-bg-basic-level-3",e.INFORMATIONAL_BG_TRANSPARENT_SEMI="informational-bg-basic-transparent-semi",e.INFORMATIONAL_BG_TRANSPARENT_FULL="informational-bg-basic-transparent-full"})(Oe||(Oe={}));Object.entries(Oe).map(([,e])=>e);Object.entries(Pe).map(([,e])=>e);var Re;(function(e){e.NEUTRAL="neutral",e.CRITICAL="critical",e.INFORMATIONAL="informational",e.WARNING="warning",e.SUCCESSFUL="successful"})(Re||(Re={}));Object.entries(Re).map(([,e])=>e);const rn={width:390,height:884},sn={width:1920,height:1280};Object.assign({name:"desktop"},sn),Object.assign({name:"mobile"},rn);function cn(e,t){const n=t||d.useRef(t);function o(a){e.onClick&&e.onClick(a)}return d.createElement("div",Object.assign({ref:n},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:e.id},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-card",e.className),"data-behavior":e.behavior,"data-elevation-level":e.elevationLevel,"data-spacing":e.spacing,onClick:a=>o(a)}),e.children)}const ln=d.forwardRef(cn);function dn(e,t){var n;const o=t||d.useRef(t);return d.createElement("span",Object.assign({ref:o},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:e.id},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-infotext",e.className),"data-icon":e.icon,"data-semantic":e.semantic,"data-size":e.size,"data-show-icon-leading":k((n=e.showIcon)!==null&&n!==void 0?n:!0)}),e.text?d.createElement(d.Fragment,null,e.text):d.createElement(d.Fragment,null,e.children))}const Ee=d.forwardRef(dn);function un(e,t){var n;const o=t||d.useRef(t);return d.createElement("div",Object.assign({ref:o},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{"data-icon":(n=e.icon)!==null&&n!==void 0?n:on,"data-show-icon":k(e.showIcon),id:e.id},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-control-panel-brand",e.className)}),e.text?d.createElement(d.Fragment,null,e.text):d.createElement(d.Fragment,null,e.children),d.createElement(d.Fragment,null,e.additionalInformation))}const fn=d.forwardRef(un),hn=e=>{var t;const{top:n,bottom:o,left:a,right:i}=e.getBoundingClientRect(),{innerHeight:r,innerWidth:s}=window;let c=n<0,l=o>r,f=a<0,u=i>s;const h=e.dataset.outsideVy,g=e.dataset.outsideVx,b=(t=e?.parentElement)===null||t===void 0?void 0:t.getBoundingClientRect();return b&&(h&&(e.dataset.outsideVy==="top"?c=b.top-(o-b.bottom)<0:l=b.bottom+(b.top-n)>r),g&&(e.dataset.outsideVx==="left"?f=b.left-(i-b.right)<0:u=b.right+(b.left-a)>s)),{outTop:c,outBottom:l,outLeft:f,outRight:u}},gn=e=>{const{outTop:t,outBottom:n,outLeft:o,outRight:a}=hn(e);let i={};return t||n?(i={vy:t?"top":"bottom"},e.dataset.outsideVy=i.vy):delete e.dataset.outsideVy,o||a?(i=Object.assign(Object.assign({},i),{vx:a?"right":"left"}),e.dataset.outsideVx=i.vx):delete e.dataset.outsideVx,i},bn=(e,t,n)=>{if(!e||!t)return{top:0,bottom:0,right:0,height:0,width:0,left:0,childHeight:0,childWidth:0,correctedPlacement:n,innerWidth:window.innerWidth,innerHeight:window.innerHeight};const o=e.getBoundingClientRect(),{top:a,height:i,bottom:r,right:s,left:c,width:l}=t.getBoundingClientRect(),{innerHeight:f,innerWidth:u}=window;let h=o.height,g=o.width;(n==="bottom"||n==="top")&&(g=l>g?0:g/2),(n==="left"||n==="right")&&(h=i>h?0:h/2);const b=Math.floor(r+h)>f,m=Math.ceil(a-h)<0,I=Math.ceil(c-g)<0,v=Math.floor(s+g)>u;let S=n;return n.startsWith("bottom")?b?m||(S=n?.replace("bottom","top"),I&&v?S="top":I?S="top-start":v&&(S="top-end")):I&&v?S="bottom":I?S="bottom-start":v&&(S="bottom-end"):n.startsWith("top")?m?b||(S=n?.replace("top","bottom"),I&&v?S="bottom":I?S="bottom-start":v&&(S="bottom-end")):I&&v?S="top":I?S="top-start":v&&(S="top-end"):n.startsWith("left")?I?v&&(S=n?.replace("left","right"),b&&m?S="right":b?S="right-end":m&&(S="right-start")):b&&m?S="left":b?S="left-end":m&&(S="left-start"):S.startsWith("right")&&(v?I||(S=n?.replace("right","left"),b&&m?S="left":b?S="left-end":m&&(S="left-start")):b&&m?S="right":b?S="right-end":m&&(S="right-start")),{top:a,bottom:r,right:s,height:i,width:l,left:c,childHeight:o.height,childWidth:o.width,correctedPlacement:S,innerWidth:u,innerHeight:f,outsideYBoth:m&&b,outsideXBoth:v&&I}},ke=(e,t,n)=>{var o,a,i;const r=getComputedStyle(e);if(r.position!=="fixed"&&r.position!=="absolute")return;let s=r.getPropertyValue("--db-popover-distance");s.length||(s="0px");const c=(i=(a=(o=e?.dataset)===null||o===void 0?void 0:o.placement)!==null&&a!==void 0?a:n)!==null&&i!==void 0?i:"bottom",{top:l,height:f,width:u,childHeight:h,childWidth:g,right:b,left:m,bottom:I,correctedPlacement:v,innerWidth:S,innerHeight:E,outsideYBoth:y}=bn(e,t,c);if(g>u&&(v.startsWith("bottom")||v.startsWith("top"))){const p=u/2/g*100;v.endsWith("start")?e.style.setProperty("--db-tooltip-arrow-inline-start",`${p}%`):v.endsWith("end")&&e.style.setProperty("--db-tooltip-arrow-inline-start",`${100-p}%`)}if(h>f&&(v.startsWith("left")||v.startsWith("bottom"))){const p=f/2/h*100;v.endsWith("start")?e.style.setProperty("--db-tooltip-arrow-block-start",`${p}%`):v.endsWith("end")&&e.style.setProperty("--db-tooltip-arrow-block-start",`${100-p}%`)}if(v==="right"||v==="left")e.style.insetBlockStart=`${l+f/2}px`;else if(v==="right-start"||v==="left-start"){const p=l+h;e.style.insetBlockStart=`${l}px`,e.style.insetBlockEnd=`${p>E?E:p}px`}else if(v==="right-end"||v==="left-end"){const p=I-h;e.style.insetBlockStart=`${p<0?0:p}px`,e.style.insetBlockEnd=`${I}px`}else if(v==="top"||v==="bottom")e.style.insetInlineStart=`${m+u/2}px`;else if(v==="top-start"||v==="bottom-start"){const p=m+g;e.style.insetInlineStart=`${m}px`,e.style.insetInlineEnd=`${p>S?S:p}px`}else if(v==="top-end"||v==="bottom-end"){const p=m-g;e.style.insetInlineStart=`${b-g}px`,e.style.insetInlineEnd=`${p<0?0:p}px`}if(v?.startsWith("right")){const p=b+g;e.style.insetInlineStart=`calc(${b}px + ${s})`,e.style.insetInlineEnd=`calc(${p>S?S:p}px + ${s})`}else if(v?.startsWith("left")){const p=m-g;e.style.insetInlineStart=`calc(${p<0?0:p}px - ${s})`,e.style.insetInlineEnd=`calc(${b}px - ${s})`}else if(v?.startsWith("top")){const p=l-h;e.style.insetBlockStart=`calc(${p<0?0:p}px - ${s})`,e.style.insetBlockEnd=`calc(${I}px - ${s})`}else if(v?.startsWith("bottom")){const p=I+h;e.style.insetBlockStart=`calc(${I}px + ${s})`,e.style.insetBlockEnd=`calc(${p>E?E:p}px + ${s})`}y&&(e.style.overflow="hidden auto",e.style.insetBlock=s,e.style.maxBlockSize=`calc(${E}px - 2 * ${s})`),e.style.position="fixed",e.dataset.correctedPlacement=v},mn=e=>{var t;const{target:n}=e;return!!(!((t=n?.parentElement)===null||t===void 0)&&t.classList.contains("db-navigation-item"))};class vn{constructor(t,n){var o,a;this.parentSubNavigation=null,this.initialized=!1,this.mouseX=0,this.mouseY=0,this.element=t,this.subNavigation=n,!(!this.element||!this.subNavigation)&&(this.parentSubNavigation=(a=(o=this.element)===null||o===void 0?void 0:o.closest(".db-navigation-item-group-menu"))!==null&&a!==void 0?a:this.element,this.element.closest(".db-drawer")||this.init())}init(){var t,n,o;const a=(n=(t=this.parentSubNavigation)===null||t===void 0?void 0:t.getBoundingClientRect().width)!==null&&n!==void 0?n:0;(o=this.element)===null||o===void 0||o.style.setProperty("--db-navigation-item-inline-size",`${a}px`),this.initialized=!0}enableFollow(){var t,n;if(!this.initialized||this.triangleData||!this.element||!this.subNavigation)return;const o=gn(this.subNavigation),a=this.element.getBoundingClientRect(),i=(n=(t=this.parentSubNavigation)===null||t===void 0?void 0:t.getBoundingClientRect().width)!==null&&n!==void 0?n:0;this.triangleData={itemRect:a,parentElementWidth:i,subNavigationHeight:this.subNavigation.getBoundingClientRect().height,padding:(i-a.width)/2,outsideVX:o.vx,outsideVY:o.vy}}disableFollow(){this.triangleData=void 0}getTriangleTipX(){return this.triangleData?this.triangleData.outsideVX==="right"?this.triangleData.itemRect.width-this.mouseX:Math.min(this.mouseX,this.triangleData.itemRect.width*.75):0}getTriangleTipY(){if(!this.triangleData)return 0;const t=Math.max(Math.min(this.mouseY,this.triangleData.itemRect.height),0)+this.triangleData.padding;return this.triangleData.outsideVY==="bottom"?t+(this.triangleData.subNavigationHeight-this.triangleData.padding*2-this.triangleData.itemRect.height):t}hasMouseEnteredSubNavigation(){if(!this.triangleData)return!1;const t=this.triangleData.outsideVX==="right";return!!(t&&this.mouseX<-1*this.triangleData.padding||!t&&this.mouseX>this.triangleData.parentElementWidth-this.triangleData.padding)}getTriangleCoordinates(){if(!this.triangleData)return;const t=this.getTriangleTipX(),n=this.getTriangleTipY(),o=`${t}px ${n}px`,a=`${t}px ${n}px`;return{lb:o,lt:a,rt:"100% 0",rb:"100% 100%"}}followByMouseEvent(t){if(!this.initialized||!this.triangleData||!this.element||!this.subNavigation)return;this.mouseX=t.clientX-this.triangleData.itemRect.left,this.mouseY=t.clientY-this.triangleData.itemRect.top;const n=this.hasMouseEnteredSubNavigation(),o=this.getTriangleCoordinates();o&&(this.element.style.setProperty("--db-navigation-item-clip-path",`polygon(${o.lb}, ${o.lt}, ${o.rt}, ${o.rb})`),n&&(this.triangleData=void 0))}}const ee=(e,t=0)=>{for(const n of Array.from(e.querySelectorAll(".db-navigation-item-group"))){const o=n.querySelector(".db-navigation-item-group-menu"),a=n.querySelector(".db-navigation-item-group-expand-button");if(o&&a){if(getComputedStyle(o).getPropertyValue("--db-navigation-item-group-menu-mobile"))return;t>0||o.dataset.open==="horizontal"?(ke(o,a,"right-start"),o.dataset.open="horizontal"):(ke(o,a,"bottom-start"),o.dataset.open="vertical"),ee(o,t+1)}}};class ${static runCallbacks(t){for(const n of Object.values($.callbacks))typeof n=="function"&&n(t)}constructor(){if(this.ticking=!1,$._instance)return $._instance;$._instance=this,self.document&&self.document.addEventListener("scroll",t=>{this.ticking||(window.requestAnimationFrame(()=>{$.runCallbacks(t),this.ticking=!1}),this.ticking=!0)},!0)}addCallback(t){const n=Q();return $.callbacks[n]=t,n}removeCallback(t){delete $.callbacks[t]}}$.callbacks={};$._instance=null;function Sn(e,t){var n,o;const a=t||d.useRef(t),[i,r]=d.useState(()=>Qt),[s,c]=d.useState(()=>!1),[l,f]=d.useState(()=>{}),[u,h]=d.useState(()=>{});function g(y){y.stopPropagation()}function b(y){(!y||y.key==="Escape")&&a.current&&getComputedStyle(a.current).visibility==="visible"&&m().blur()}function m(){let y=a.current.parentElement;return y&&y.localName.includes("tooltip")&&(y=y.parentElement),y}function I(y){y&&a.current&&J(()=>{ke(a.current,y)},1)}function v(y,p){var T,_;!((T=y?.target)===null||T===void 0)&&T.contains&&(!((_=y?.target)===null||_===void 0)&&_.contains(a.current))&&I(p)}function S(){l&&new $().removeCallback(l),u?.unobserve(m())}function E(y){f(new $().addCallback(p=>v(p,y))),I(y),u?.observe(m())}return d.useEffect(()=>{r(e.id||"tooltip-"+Q()),c(!0)},[]),d.useEffect(()=>{if(a.current&&s&&i){const y=m();y&&(["mouseenter","focusin"].forEach(p=>{y.addEventListener(p,()=>E(y))}),y.addEventListener("keydown",p=>b(p)),["mouseleave","focusout"].forEach(p=>{y.addEventListener(p,()=>S())}),y.dataset.hasTooltip="true",e.variant==="label"?y.setAttribute("aria-labelledby",i):y.setAttribute("aria-describedby",i)),typeof window<"u"&&"IntersectionObserver"in window&&h(new IntersectionObserver(p=>{const T=p.find(({target:_})=>_===m());T&&!T.isIntersecting&&b(!1)})),c(!1)}},[a.current,s]),d.createElement("i",Object.assign({role:"tooltip","aria-hidden":"true","data-gap":"true",ref:a},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-tooltip",e.className),id:i,"data-emphasis":e.emphasis,"data-animation":k((n=e.animation)!==null&&n!==void 0?n:!0),"data-delay":e.delay,"data-width":e.width,"data-show-arrow":k((o=e.showArrow)!==null&&o!==void 0?o:!0),"data-placement":e.placement,onClick:y=>g(y)}),e.children)}const le=d.forwardRef(Sn);function yn(e,t){var n,o,a;const i=t||d.useRef(t),r=d.useRef(null),[s,c]=d.useState(()=>`db-control-panel-desktop-${Q()}`),[l,f]=d.useState(()=>!0);function u(m){typeof m.detail!="object"&&(m.stopPropagation(),f(!l))}function h(){if(e.onExpandButtonTooltipFn){const m=l;return e.onExpandButtonTooltipFn(m)}return e.expandButtonTooltip?e.expandButtonTooltip:l?Nt:_t}function g(){if(!r.current)return;const m=r.current.querySelector('.db-navigation[data-variant="popover"]');if(!m)return;const I=m.querySelector("menu");I&&ee(I)}const b=d.useRef(!1);return b.current||(e.expanded!==void 0&&f((n=j(e.expanded,"expanded"))!==null&&n!==void 0?n:!0),b.current=!0),d.createElement("header",Object.assign({ref:i},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font","onToggle"]),z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-control-panel-desktop",e.className),id:(o=e.id)!==null&&o!==void 0?o:s,"data-width":e.width,"data-orientation":e.orientation,"data-open":k(l)}),d.createElement(d.Fragment,null,e.brand),d.createElement("div",{className:"db-control-panel-desktop-scroll-container",ref:r,onScroll:m=>g()},e.children,d.createElement(d.Fragment,null,e.metaNavigation)),d.createElement(d.Fragment,null,e.primaryActions),d.createElement(d.Fragment,null,e.secondaryActions),d.createElement("div",{className:"db-control-panel-desktop-button"},d.createElement(K,{variant:"ghost",type:"button",icon:"double_chevron_left",onClick:m=>u(m),"aria-controls":(a=e.id)!==null&&a!==void 0?a:s,"aria-expanded":l,noText:!0},d.createElement(le,{variant:"label",placement:"right"},h()))))}const pn=d.forwardRef(yn);function In(e,t){var n;const o=t||d.useRef(t),a=d.useRef(null),[i,r]=d.useState(()=>!1);function s(l,f){var u;l&&(Yt(l)?l.key==="Escape"&&(l.preventDefault(),e.onClose&&e.onClose(l)):(f&&(l.stopPropagation(),e.onClose&&e.onClose(l)),((u=l.target)===null||u===void 0?void 0:u.nodeName)==="DIALOG"&&l.type==="click"&&e.backdrop!=="none"&&e.onClose&&e.onClose(l)))}function c(){if(o.current){const l=!!e.open;l&&!o.current.open&&(a.current&&(a.current.hidden=!1),e.position==="absolute"||e.backdrop==="none"||e.variant==="inside"?o.current.show():o.current.showModal()),!l&&o.current.open&&(a.current&&(a.current.hidden=!0),J(()=>{var f;a.current&&(a.current.hidden=!1),(f=o.current)===null||f===void 0||f.close()},401))}}return d.useEffect(()=>{c(),r(!0)},[]),d.useEffect(()=>{c()},[e.open]),d.useEffect(()=>{if(o.current&&i&&e.position==="absolute"){const f=o.current.parentElement;f&&(f.style.position="relative")}},[o.current,i,e.position]),d.createElement("dialog",Object.assign({className:"db-drawer",id:e.id,ref:o},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font","onClose"]),{onClick:l=>s(l),onKeyDown:l=>s(l),"data-position":e.position,"data-backdrop":e.backdrop,"data-direction":e.direction,"data-variant":e.variant}),d.createElement("article",Object.assign({ref:a},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-drawer-container",e.className),"data-spacing":e.spacing,"data-width":e.width,"data-direction":e.direction,"data-rounded":k(e.rounded)}),d.createElement("header",{className:"db-drawer-header"},d.createElement("div",{className:"db-drawer-header-text"},e.drawerHeaderPlain?d.createElement(d.Fragment,null,e.drawerHeaderPlain):d.createElement(d.Fragment,null,d.createElement(d.Fragment,null,e.drawerHeader))),d.createElement(K,{className:"button-close-drawer",icon:"cross",variant:"ghost",type:"button",id:e.closeButtonId,noText:!0,onClick:l=>s(l,!0)},(n=e.closeButtonText)!==null&&n!==void 0?n:an)),d.createElement("div",{className:"db-drawer-content"},e.children)))}const wt=d.forwardRef(In);function En(e,t){var n;const o=t||d.useRef(void 0),[a,i]=d.useState(()=>!1);function r(c){c.stopPropagation&&c.stopPropagation();const l=!a;i(l),e.onToggle&&e.onToggle(l)}function s(c){mn(c)&&r(c)}return d.createElement("header",Object.assign({"data-density":"regular",ref:o},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:e.id,"data-width":e.width,"data-position":e.position,"data-variant":e.variant},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-control-panel-mobile",e.className)}),d.createElement(wt,{direction:"custom",spacing:"small",drawerHeaderPlain:e.drawerHeadlinePlain,rounded:!0,open:a,onClose:c=>r(c)},d.createElement("div",{className:"db-control-panel-mobile-drawer-scroll-container",onClick:c=>s(c)},e.children,d.createElement(d.Fragment,null,e.metaNavigation)),d.createElement(d.Fragment,null,e.secondaryActions)),d.createElement(d.Fragment,null,e.flatIconNavigation),d.createElement(d.Fragment,null,e.brand),d.createElement(d.Fragment,null,e.primaryActions),d.createElement(K,{className:"db-control-panel-mobile-button",icon:"menu",type:"button",variant:"ghost",noText:!0,onClick:c=>r(c)},(n=e.burgerMenuLabel)!==null&&n!==void 0?n:nn))}const _n=d.forwardRef(En);function Nn(e,t){const n=t||d.useRef(void 0);return d.createElement("div",Object.assign({ref:n},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:e.id},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-control-panel-primary-actions",e.className)}),e.children)}const wn=d.forwardRef(Nn);function Tn(e,t){var n,o,a,i,r,s;const c=t||d.useRef(t),[l,f]=d.useState(()=>{}),[u,h]=d.useState(()=>{}),[g,b]=d.useState(()=>{}),[m,I]=d.useState(()=>{}),[v,S]=d.useState(()=>{}),[E,y]=d.useState(()=>{}),[p,T]=d.useState(()=>{}),[_,w]=d.useState(()=>{}),[O,D]=d.useState(()=>"");function R(){var N;return!!((N=e.validMessage)!==null&&N!==void 0?N:e.validation==="valid")}function F(){var N,x,ve,Se;!(!((N=c.current)===null||N===void 0)&&N.validity.valid)||e.validation==="invalid"?(T(m),S(e.invalidMessage||((x=c.current)===null||x===void 0?void 0:x.validationMessage)||Ie),Ge()&&(D(v),J(()=>D(""),1e3))):R()&&(!((ve=c.current)===null||ve===void 0)&&ve.validity.valid)&&(e.required||e.minLength||e.maxLength||e.pattern)?(T(g),Ge()&&(D((Se=e.validMessage)!==null&&Se!==void 0?Se:Ke),J(()=>D(""),1e3))):ye(e.message,e.showMessage)?T(u):T(void 0)}function H(N){e.onInput&&e.onInput(N),F()}function L(N){e.onChange&&e.onChange(N),F()}function B(N){e.onBlur&&e.onBlur(N)}function Y(N){e.onFocus&&e.onFocus(N)}function oe(){const N=e.dataList;return Array.from((qt(N)?N?.map(x=>({value:x,label:void 0})):N)||[])}return d.useEffect(()=>{var N;const x=(N=e.id)!==null&&N!==void 0?N:`input-${Q()}`;f(x),h(x+He),b(x+Ye),I(x+qe),y(x+Je),S(e.invalidMessage||Ie)},[]),d.useEffect(()=>{var N;S(e.invalidMessage||((N=c.current)===null||N===void 0?void 0:N.validationMessage)||Ie)},[c.current,e.invalidMessage]),d.useEffect(()=>{var N;if(l){const x=l+He;h(x),b(l+Ye),I(l+qe),y((N=e.dataListId)!==null&&N!==void 0?N:l+Je),ye(e.message,e.showMessage)&&T(x),F()}},[l]),d.useEffect(()=>{w(e.value)},[e.value]),d.createElement("div",Object.assign({},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-input",e.className),"data-variant":e.variant,"data-hide-label":De(e.showLabel),"data-show-icon":k((n=e.showIconLeading)!==null&&n!==void 0?n:e.showIcon),"data-icon":(o=e.iconLeading)!==null&&o!==void 0?o:e.icon,"data-icon-trailing":e.iconTrailing,"data-hide-asterisk":De(e.showRequiredAsterisk),"data-show-icon-trailing":k(e.showIconTrailing)}),d.createElement("label",{htmlFor:l},(a=e.label)!==null&&a!==void 0?a:Et),d.createElement("input",Object.assign({"aria-invalid":e.validation==="invalid","data-custom-validity":e.validation,"data-field-sizing":e.fieldSizing,ref:c},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:l,name:e.name,type:e.type||"text",multiple:j(e.multiple,"multiple"),placeholder:(i=e.placeholder)!==null&&i!==void 0?i:en,disabled:j(e.disabled,"disabled"),required:j(e.required,"required"),step:pe(e.step),value:e.value,maxLength:pe(e.maxLength,e.maxlength),minLength:pe(e.minLength,e.minlength),max:je(e.max,e.type),min:je(e.min,e.type),readOnly:j(e.readOnly,"readOnly")||j(e.readonly,"readonly"),form:e.form,pattern:e.pattern,size:e.size,autoComplete:e.autocomplete,autoFocus:j(e.autofocus,"autofocus"),onInput:N=>H(N),onChange:N=>L(N),onBlur:N=>B(N),onFocus:N=>Y(N),list:e.dataList&&E,"aria-describedby":(r=e.ariaDescribedBy)!==null&&r!==void 0?r:p})),e.dataList?d.createElement("datalist",{id:E},(s=oe())===null||s===void 0?void 0:s.map(N=>d.createElement("option",{key:E+"-option-"+N.value,value:N.value},N.label))):null,e.children,ye(e.message,e.showMessage)?d.createElement(Ee,{size:"small",icon:e.messageIcon,id:u},e.message):null,R()?d.createElement(Ee,{size:"small",semantic:"successful",id:g},e.validMessage||Ke):null,d.createElement(Ee,{size:"small",semantic:"critical",id:m},v),d.createElement("span",{"data-visually-hidden":"true",role:"status"},O))}const Dn=d.forwardRef(Tn);function An(e,t){var n;const o=t||d.useRef(t),a=d.useRef(null),[i,r]=d.useState(()=>!1),[s,c]=d.useState(()=>!1),[l,f]=d.useState(()=>{}),[u,h]=d.useState(()=>{}),[g,b]=d.useState(()=>{}),[m,I]=d.useState(()=>!1),[v,S]=d.useState(()=>!1);function E(_){const w=_.scrollWidth>_.clientWidth,O=Math.ceil(_.scrollLeft);r(w&&O>1),c(w&&O<_.scrollWidth-_.clientWidth)}function y(_){var w;let O=Number(e.arrowScrollDistance)||100;_&&(O*=-1),(w=a.current)===null||w===void 0||w.scrollBy({top:0,left:O,behavior:"smooth"})}function p(){E(a.current),T()}function T(){ee(a.current,l==="left"||l==="top"&&u==="left"&&v?1:0)}return d.useEffect(()=>{I(!0)},[]),d.useEffect(()=>{o.current&&m&&J(()=>{var _,w,O,D,R;const F=o.current;if(!F)return;let H=(_=e.variant)!==null&&_!==void 0?_:"popover";const L=!((w=F.parentElement)===null||w===void 0)&&w.nodeName.startsWith("DB")?(D=(O=F.parentElement)===null||O===void 0?void 0:O.parentElement)===null||D===void 0?void 0:D.classList:(R=F.parentElement)===null||R===void 0?void 0:R.classList,B=F.closest(".db-shell"),Y=B?.getAttribute("data-control-panel-desktop-position"),oe=B?.getAttribute("data-sub-navigation-desktop-position");f(Y),h(oe);const N=L?.contains("db-shell-sub-navigation");S(N),(Y==="top"&&L?.contains("db-control-panel-desktop-scroll-container")||(oe==="top"||Y==="left")&&N)&&(H="popover"),b(H)},1)},[o.current,e.variant,m]),d.useEffect(()=>{var _;if(a.current&&g){if(!g||g==="popover")T();else if(g==="tree"){for(const w of Array.from(a.current.querySelectorAll(".db-navigation-item-group-menu")))w.style.position="";for(const w of Array.from(a.current.querySelectorAll(".db-navigation-item, .db-navigation-item-group")))w.setAttribute("role","none"),(_=w.querySelector("a, button"))===null||_===void 0||_.setAttribute("role","treeitem")}E(a.current)}},[a.current,g,l]),d.createElement("nav",Object.assign({ref:o},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:e.id,"data-variant":g,"data-show-tree-line":k((n=e.showTreeLine)!==null&&n!==void 0?n:"true"),onScroll:_=>p()},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-navigation",e.className)}),i?d.createElement(K,{className:"overflow-scroll-left-button",variant:"filled",icon:"chevron_left",type:"button",noText:!0,onClick:_=>y(!0)},"Scroll left"):null,d.createElement("menu",{role:g==="tree"?"tree":void 0,ref:a,onScroll:_=>p()},e.children),s?d.createElement(K,{className:"overflow-scroll-right-button",variant:"filled",icon:"chevron_right",type:"button",noText:!0,onClick:_=>y()},"Scroll right"):null)}const Tt=d.forwardRef(An);function Pn(e,t){var n;const o=t||d.useRef(t);return d.createElement("li",Object.assign({ref:o},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:e.id},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-navigation-item",e.className),"data-icon":e.icon,"data-show-icon":k(e.showIcon),"data-active":k(e.active),"aria-disabled":k(e.disabled)}),e.children,d.createElement(d.Fragment,null,e.additionalInformation),d.createElement(le,{placement:"right",delay:"slow"},(n=e.tooltip)!==null&&n!==void 0?n:Et))}const Xe=d.forwardRef(Pn);function On(e,t){var n;const o=t||d.useRef(void 0),a=d.useRef(void 0),i=d.useRef(void 0),[r,s]=d.useState(()=>!0),[c,l]=d.useState(()=>!1),[f,u]=d.useState(()=>!1),[h,g]=d.useState(()=>!1),[b,m]=d.useState(()=>!1),[I,v]=d.useState(()=>"db-navigation-item-group-menu-"+Q()),[S,E]=d.useState(()=>{});function y(){h&&ee(o.current)}function p(D){var R;((R=D?.target)===null||R===void 0?void 0:R.nodeName)==="A"&&T()}function T(){u(!0),J(()=>{u(!1)},300)}function _(D){e.onClick&&(D.stopPropagation(),e.onClick(D)),l(!c)}function w(D){D.stopPropagation(),l(!1)}function O(D){(!D||D.key==="Escape")&&(T(),i.current.blur())}return d.useEffect(()=>{m(!0)},[]),d.useEffect(()=>{e.expanded!==void 0&&l(!!j(e.expanded,"subNavigationExpanded"))},[e.expanded]),d.useEffect(()=>{o.current&&b&&(m(!1),J(()=>{const R=o.current.closest(".db-navigation");g(!R||!R.dataset.variant||R.dataset.variant==="popover")},200))},[o.current,b]),d.useEffect(()=>{o.current&&i.current&&a.current&&h&&!S&&(J(()=>{E(new vn(o.current,a.current))},1),["mouseenter","focusin"].forEach(D=>{o.current.addEventListener(D,()=>ee(a.current))}))},[o.current,a.current,i.current,h]),d.createElement("li",Object.assign({ref:o},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:e.id,onMouseOver:D=>S?.enableFollow(),onMouseLeave:D=>S?.disableFollow(),onMouseMove:D=>S?.followByMouseEvent(D),onKeyDown:D=>O(D)},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-navigation-item-group",e.className),"data-icon":e.icon,"data-hide-icon":De(e.showIcon),"data-active":e.active,"aria-disabled":k(e.disabled)}),d.createElement("button",{type:"button",className:"db-navigation-item-group-expand-button",ref:i,"aria-haspopup":k(h?!0:void 0),"aria-owns":h?void 0:I,"aria-expanded":k(c),disabled:j(e.disabled,"disabled"),onClick:D=>_(D)},e.text,d.createElement(d.Fragment,null,e.additionalInformation)),d.createElement("menu",{className:"db-navigation-item-group-menu",role:"group",ref:a,"data-force-close":k(f),id:I,onScroll:D=>y(),onClick:D=>p(D)},d.createElement("div",{className:"db-navigation-item-group-back-button"},d.createElement(K,{icon:"arrow_left",variant:"ghost",id:e.backButtonId,onClick:D=>w(D)},(n=e.backButtonText)!==null&&n!==void 0?n:tn)),e.children))}const Rn=d.forwardRef(On);function kn(e,t){var n,o,a,i;const r=t||d.useRef(t),[s,c]=d.useState(()=>!1);return d.useEffect(()=>{c(!e.fadeIn),document&&e.fadeIn?document.fonts.ready.then(()=>{c(!0)}):c(!0)},[]),d.createElement("div",Object.assign({ref:r},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:e.id},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-shell",e.className),"data-control-panel-desktop-position":(n=e.controlPanelDesktopPosition)!==null&&n!==void 0?n:"top","data-control-panel-mobile-position":(o=e.controlPanelMobilePosition)!==null&&o!==void 0?o:"top","data-sub-navigation-desktop-position":(a=e.subNavigationDesktopPosition)!==null&&a!==void 0?a:"top","data-sub-navigation-mobile-position":(i=e.subNavigationMobilePosition)!==null&&i!==void 0?i:"top","data-show-sub-navigation":k(e.showSubNavigation),"data-fade-in":k(e.fadeIn),"data-fonts-loaded":k(s)}),d.createElement(d.Fragment,null,e.controlPanelDesktop),d.createElement(d.Fragment,null,e.controlPanelMobile),d.createElement(d.Fragment,null,e.subNavigation),d.createElement("main",{className:M("db-main",e.mainClass)},e.children))}const Ln=d.forwardRef(kn);function xn(e,t){var n,o,a;const i=t||d.useRef(void 0),[r,s]=d.useState(()=>`db-shell-sub-navigation-${Q()}`),[c,l]=d.useState(()=>!0);function f(g){g.stopPropagation(),l(!c)}function u(){var g;return e.expandButtonTooltip?e.expandButtonTooltip:(g=(()=>{if(e.onExpandButtonTooltipFn){const m=c;return e.onExpandButtonTooltipFn(m)}})())!==null&&g!==void 0?g:c?Nt:_t}const h=d.useRef(!1);return h.current||(e.expanded!==void 0&&l((n=j(e.expanded,"expanded"))!==null&&n!==void 0?n:!0),h.current=!0),d.createElement("div",Object.assign({ref:i},C(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{id:(o=e.id)!==null&&o!==void 0?o:r,"data-open":k(c)},z(e,["data-icon-variant","data-icon-variant-before","data-icon-variant-after","data-icon-weight","data-icon-weight-before","data-icon-weight-after","data-interactive","data-force-mobile","data-color","data-container-color","data-bg-color","data-on-bg-color","data-color-scheme","data-font-size","data-headline-size","data-divider","data-focus","data-font"]),{className:M("db-shell-sub-navigation",e.className)}),e.children,d.createElement("div",{className:"db-shell-sub-navigation-button"},d.createElement(K,{variant:"ghost",icon:"double_chevron_left",onClick:g=>f(g),"aria-controls":(a=e.id)!==null&&a!==void 0?a:r,"aria-expanded":k(c),noText:!0},d.createElement(le,{variant:"label",placement:"right"},u()))))}const Mn=d.forwardRef(xn),Dt={arabic:"ar",armenian:"am",bulgarian:"bg",czech:"cz",danish:"dk",dutch:"nl",english:"en",finnish:"fi",french:"fr",german:"de",greek:"gr",hungarian:"hu",indian:"in",indonesian:"id",irish:"ie",italian:"it",lithuanian:"lt",nepali:"np",norwegian:"no",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"rs",slovenian:"ru",spanish:"es",swedish:"se",tamil:"ta",turkish:"tr",ukrainian:"uk",sanskrit:"sk"},Bn={dutch:/[^A-Za-zàèéìòóù0-9_'-]+/gim,english:/[^A-Za-zàèéìòóù0-9_'-]+/gim,french:/[^a-z0-9äâàéèëêïîöôùüûœç-]+/gim,italian:/[^A-Za-zàèéìòóù0-9_'-]+/gim,norwegian:/[^a-z0-9_æøåÆØÅäÄöÖüÜ]+/gim,portuguese:/[^a-z0-9à-úÀ-Ú]/gim,russian:/[^a-z0-9а-яА-ЯёЁ]+/gim,spanish:/[^a-z0-9A-Zá-úÁ-ÚñÑüÜ]+/gim,swedish:/[^a-z0-9_åÅäÄöÖüÜ-]+/gim,german:/[^a-z0-9A-ZäöüÄÖÜß]+/gim,finnish:/[^a-z0-9äöÄÖ]+/gim,danish:/[^a-z0-9æøåÆØÅ]+/gim,hungarian:/[^a-z0-9áéíóöőúüűÁÉÍÓÖŐÚÜŰ]+/gim,romanian:/[^a-z0-9ăâîșțĂÂÎȘȚ]+/gim,serbian:/[^a-z0-9čćžšđČĆŽŠĐ]+/gim,turkish:/[^a-z0-9çÇğĞıİöÖşŞüÜ]+/gim,lithuanian:/[^a-z0-9ąčęėįšųūžĄČĘĖĮŠŲŪŽ]+/gim,arabic:/[^a-z0-9أ-ي]+/gim,nepali:/[^a-z0-9अ-ह]+/gim,irish:/[^a-z0-9áéíóúÁÉÍÓÚ]+/gim,indian:/[^a-z0-9अ-ह]+/gim,armenian:/[^a-z0-9ա-ֆ]+/gim,greek:/[^a-z0-9α-ωά-ώ]+/gim,indonesian:/[^a-z0-9]+/gim,ukrainian:/[^a-z0-9а-яА-ЯіїєІЇЄ]+/gim,slovenian:/[^a-z0-9čžšČŽŠ]+/gim,bulgarian:/[^a-z0-9а-яА-Я]+/gim,tamil:/[^a-z0-9அ-ஹ]+/gim,sanskrit:/[^a-z0-9A-Zāīūṛḷṃṁḥśṣṭḍṇṅñḻḹṝ]+/gim,czech:/[^A-Z0-9a-zěščřžýáíéúůóťďĚŠČŘŽÝÁÍÉÓÚŮŤĎ-]+/gim},xe=Object.keys(Dt);function Cn(e){return e!==void 0&&xe.includes(e)?Dt[e]:void 0}const zn=Date.now().toString().slice(5);let Fn=0;const Ze=BigInt(1e3),Qe=BigInt(1e6),et=BigInt(1e9),_e=65535;function At(e,t){if(t.length<_e)Array.prototype.push.apply(e,t);else{const n=t.length;for(let o=0;o<n;o+=_e)Array.prototype.push.apply(e,t.slice(o,o+_e))}}function Un(e,...t){return e.replace(/%(?:(?<position>\d+)\$)?(?<width>-?\d*\.?\d*)(?<type>[dfs])/g,function(...n){const o=n[n.length-1],{width:a,type:i,position:r}=o,s=r?t[Number.parseInt(r)-1]:t.shift(),c=a===""?0:Number.parseInt(a);switch(i){case"d":return s.toString().padStart(c,"0");case"f":{let l=s;const[f,u]=a.split(".").map(h=>Number.parseFloat(h));return typeof u=="number"&&u>=0&&(l=l.toFixed(u)),typeof f=="number"&&f>=0?l.toString().padStart(c,"0"):l.toString()}case"s":return c<0?s.toString().padEnd(-c," "):s.toString().padStart(c," ");default:return s}})}function Vn(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function $n(){return typeof process<"u"&&process.release&&process.release.name==="node"}function tt(){return BigInt(Math.floor(performance.now()*1e6))}function Me(e){return typeof e=="number"&&(e=BigInt(e)),e<Ze?`${e}ns`:e<Qe?`${e/Ze}μs`:e<et?`${e/Qe}ms`:`${e/et}s`}function Z(){return Vn()?tt():$n()||typeof process<"u"&&typeof process?.hrtime?.bigint=="function"?process.hrtime.bigint():typeof performance<"u"?tt():BigInt(0)}function Pt(){return`${zn}-${Fn++}`}function Ne(e,t){return Object.hasOwn===void 0?Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0:Object.hasOwn(e,t)?e[t]:void 0}function Ot(e,t){return t[1]===e[1]?e[0]-t[0]:t[1]-e[1]}function Wn(e){if(e.length===0)return[];if(e.length===1)return e[0];for(let n=1;n<e.length;n++)if(e[n].length<e[0].length){const o=e[0];e[0]=e[n],e[n]=o}const t=new Map;for(const n of e[0])t.set(n,1);for(let n=1;n<e.length;n++){let o=0;for(const a of e[n]){const i=t.get(a);i===n&&(t.set(a,i+1),o++)}if(o===0)return[]}return e[0].filter(n=>{const o=t.get(n);return o!==void 0&&t.set(n,0),o===e.length})}function Rt(e,t){const n={},o=t.length;for(let a=0;a<o;a++){const i=t[a],r=i.split(".");let s=e;const c=r.length;for(let l=0;l<c;l++)if(s=s[r[l]],typeof s=="object"){if(s!==null&&"lat"in s&&"lon"in s&&typeof s.lat=="number"&&typeof s.lon=="number"){s=n[i]=s;break}else if(!Array.isArray(s)&&s!==null&&l===c-1){s=void 0;break}}else if((s===null||typeof s!="object")&&l<c-1){s=void 0;break}typeof s<"u"&&(n[i]=s)}return n}function Be(e,t){return Rt(e,[t])[t]}const jn={cm:.01,m:1,km:1e3,ft:.3048,yd:.9144,mi:1609.344};function kt(e,t){const n=jn[t];if(n===void 0)throw new Error(P("INVALID_DISTANCE_SUFFIX",e).message);return e*n}function Lt(e,t){e.hits=e.hits.map(n=>({...n,document:{...n.document,...t.reduce((o,a)=>{const i=a.split("."),r=i.pop();let s=o;for(const c of i)s[c]=s[c]??{},s=s[c];return s[r]=null,o},n.document)}}))}function de(e){return Array.isArray(e)?e.some(t=>de(t)):e?.constructor?.name==="AsyncFunction"}const nt="intersection"in new Set;function ot(...e){if(e.length===0)return new Set;if(e.length===1)return e[0];if(e.length===2){const o=e[0],a=e[1];if(nt)return o.intersection(a);const i=new Set,r=o.size<a.size?o:a,s=r===o?a:o;for(const c of r)s.has(c)&&i.add(c);return i}const t={index:0,size:e[0].size};for(let o=1;o<e.length;o++)e[o].size<t.size&&(t.index=o,t.size=e[o].size);if(nt){let o=e[t.index];for(let a=0;a<e.length;a++)a!==t.index&&(o=o.intersection(e[a]));return o}const n=e[t.index];for(let o=0;o<e.length;o++){if(o===t.index)continue;const a=e[o];for(const i of n)a.has(i)||n.delete(i)}return n}const Gn="union"in new Set;function ae(e,t){return Gn?e?e.union(t):t:e?new Set([...e,...t]):new Set(t)}function Hn(e,t){const n=new Set;for(const o of e)t.has(o)||n.add(o);return n}const Yn=xe.join(`
 - `),qn={NO_LANGUAGE_WITH_CUSTOM_TOKENIZER:"Do not pass the language option to create when using a custom tokenizer.",LANGUAGE_NOT_SUPPORTED:`Language "%s" is not supported.
Supported languages are:
 - ${Yn}`,INVALID_STEMMER_FUNCTION_TYPE:"config.stemmer property must be a function.",MISSING_STEMMER:'As of version 1.0.0 @orama/orama does not ship non English stemmers by default. To solve this, please explicitly import and specify the "%s" stemmer from the package @orama/stemmers. See https://docs.orama.com/docs/orama-js/text-analysis/stemming for more information.',CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY:"Custom stop words array must only contain strings.",UNSUPPORTED_COMPONENT:'Unsupported component "%s".',COMPONENT_MUST_BE_FUNCTION:'The component "%s" must be a function.',COMPONENT_MUST_BE_FUNCTION_OR_ARRAY_FUNCTIONS:'The component "%s" must be a function or an array of functions.',INVALID_SCHEMA_TYPE:'Unsupported schema type "%s" at "%s". Expected "string", "boolean" or "number" or array of them.',DOCUMENT_ID_MUST_BE_STRING:'Document id must be of type "string". Got "%s" instead.',DOCUMENT_ALREADY_EXISTS:'A document with id "%s" already exists.',DOCUMENT_DOES_NOT_EXIST:'A document with id "%s" does not exists.',MISSING_DOCUMENT_PROPERTY:'Missing searchable property "%s".',INVALID_DOCUMENT_PROPERTY:'Invalid document property "%s": expected "%s", got "%s"',UNKNOWN_INDEX:'Invalid property name "%s". Expected a wildcard string ("*") or array containing one of the following properties: %s',INVALID_BOOST_VALUE:"Boost value must be a number greater than, or less than 0.",INVALID_FILTER_OPERATION:"You can only use one operation per filter, you requested %d.",SCHEMA_VALIDATION_FAILURE:'Cannot insert document due schema validation failure on "%s" property.',INVALID_SORT_SCHEMA_TYPE:'Unsupported sort schema type "%s" at "%s". Expected "string" or "number".',CANNOT_SORT_BY_ARRAY:'Cannot configure sort for "%s" because it is an array (%s).',UNABLE_TO_SORT_ON_UNKNOWN_FIELD:'Unable to sort on unknown field "%s". Allowed fields: %s',SORT_DISABLED:"Sort is disabled. Please read the documentation at https://docs.orama.com/docs/orama-js for more information.",UNKNOWN_GROUP_BY_PROPERTY:'Unknown groupBy property "%s".',INVALID_GROUP_BY_PROPERTY:'Invalid groupBy property "%s". Allowed types: "%s", but given "%s".',UNKNOWN_FILTER_PROPERTY:'Unknown filter property "%s".',UNKNOWN_VECTOR_PROPERTY:'Unknown vector property "%s". Make sure the property exists in the schema and is configured as a vector.',INVALID_VECTOR_SIZE:'Vector size must be a number greater than 0. Got "%s" instead.',INVALID_VECTOR_VALUE:'Vector value must be a number greater than 0. Got "%s" instead.',INVALID_INPUT_VECTOR:`Property "%s" was declared as a %s-dimensional vector, but got a %s-dimensional vector instead.
Input vectors must be of the size declared in the schema, as calculating similarity between vectors of different sizes can lead to unexpected results.`,WRONG_SEARCH_PROPERTY_TYPE:'Property "%s" is not searchable. Only "string" properties are searchable.',FACET_NOT_SUPPORTED:`Facet doens't support the type "%s".`,INVALID_DISTANCE_SUFFIX:'Invalid distance suffix "%s". Valid suffixes are: cm, m, km, mi, yd, ft.',INVALID_SEARCH_MODE:'Invalid search mode "%s". Valid modes are: "fulltext", "vector", "hybrid".',MISSING_VECTOR_AND_SECURE_PROXY:"No vector was provided and no secure proxy was configured. Please provide a vector or configure an Orama Secure Proxy to perform hybrid search.",MISSING_TERM:'"term" is a required parameter when performing hybrid search. Please provide a search term.',INVALID_VECTOR_INPUT:'Invalid "vector" property. Expected an object with "value" and "property" properties, but got "%s" instead.',PLUGIN_CRASHED:"A plugin crashed during initialization. Please check the error message for more information:",PLUGIN_SECURE_PROXY_NOT_FOUND:`Could not find '@orama/secure-proxy-plugin' installed in your Orama instance.
Please install it before proceeding with creating an answer session.
Read more at https://docs.orama.com/docs/orama-js/plugins/plugin-secure-proxy#plugin-secure-proxy
`,PLUGIN_SECURE_PROXY_MISSING_CHAT_MODEL:`Could not find a chat model defined in the secure proxy plugin configuration.
Please provide a chat model before proceeding with creating an answer session.
Read more at https://docs.orama.com/docs/orama-js/plugins/plugin-secure-proxy#plugin-secure-proxy
`,ANSWER_SESSION_LAST_MESSAGE_IS_NOT_ASSISTANT:"The last message in the session is not an assistant message. Cannot regenerate non-assistant messages.",PLUGIN_COMPONENT_CONFLICT:'The component "%s" is already defined. The plugin "%s" is trying to redefine it.'};function P(e,...t){const n=new Error(Un(qn[e]??`Unsupported Orama Error code: ${e}`,...t));return n.code=e,"captureStackTrace"in Error.prototype&&Error.captureStackTrace(n),n}function Jn(e){return{raw:Number(e),formatted:Me(e)}}function Kn(e){if(e.id){if(typeof e.id!="string")throw P("DOCUMENT_ID_MUST_BE_STRING",typeof e.id);return e.id}return Pt()}function xt(e,t){for(const[n,o]of Object.entries(t)){const a=e[n];if(!(typeof a>"u")&&!(o==="geopoint"&&typeof a=="object"&&typeof a.lon=="number"&&typeof a.lat=="number")&&!(o==="enum"&&(typeof a=="string"||typeof a=="number"))){if(o==="enum[]"&&Array.isArray(a)){const i=a.length;for(let r=0;r<i;r++)if(typeof a[r]!="string"&&typeof a[r]!="number")return n+"."+r;continue}if(ne(o)){const i=Bt(o);if(!Array.isArray(a)||a.length!==i)throw P("INVALID_INPUT_VECTOR",n,i,a.length);continue}if(Ce(o)){if(!Array.isArray(a))return n;const i=Mt(o),r=a.length;for(let s=0;s<r;s++)if(typeof a[s]!==i)return n+"."+s;continue}if(typeof o=="object"){if(!a||typeof a!="object")return n;const i=xt(a,o);if(i)return n+"."+i;continue}if(typeof a!==o)return n}}}const Xn={string:!1,number:!1,boolean:!1,enum:!1,geopoint:!1,"string[]":!0,"number[]":!0,"boolean[]":!0,"enum[]":!0},Zn={"string[]":"string","number[]":"number","boolean[]":"boolean","enum[]":"enum"};function ne(e){return typeof e=="string"&&/^vector\[\d+\]$/.test(e)}function Ce(e){return typeof e=="string"&&Xn[e]}function Mt(e){return Zn[e]}function Bt(e){const t=Number(e.slice(7,-1));switch(!0){case isNaN(t):throw P("INVALID_VECTOR_VALUE",e);case t<=0:throw P("INVALID_VECTOR_SIZE",e);default:return t}}function Qn(){return{idToInternalId:new Map,internalIdToId:[],save:eo,load:to}}function eo(e){return{internalIdToId:e.internalIdToId}}function to(e,t){const{internalIdToId:n}=t;e.internalDocumentIDStore.idToInternalId.clear(),e.internalDocumentIDStore.internalIdToId=[];const o=n.length;for(let a=0;a<o;a++){const i=n[a];e.internalDocumentIDStore.idToInternalId.set(i,a+1),e.internalDocumentIDStore.internalIdToId.push(i)}}function W(e,t){if(typeof t=="string"){const n=e.idToInternalId.get(t);if(n)return n;const o=e.idToInternalId.size+1;return e.idToInternalId.set(t,o),e.internalIdToId.push(t),o}return t>e.internalIdToId.length?W(e,t.toString()):t}function ue(e,t){if(e.internalIdToId.length<t)throw new Error(`Invalid internalId ${t}`);return e.internalIdToId[t-1]}function no(e,t){return{sharedInternalDocumentStore:t,docs:{},count:0}}function oo(e,t){const n=W(e.sharedInternalDocumentStore,t);return e.docs[n]}function ao(e,t){const n=t.length,o=Array.from({length:n});for(let a=0;a<n;a++){const i=W(e.sharedInternalDocumentStore,t[a]);o[a]=e.docs[i]}return o}function io(e){return e.docs}function ro(e,t,n,o){return typeof e.docs[n]<"u"?!1:(e.docs[n]=o,e.count++,!0)}function so(e,t){const n=W(e.sharedInternalDocumentStore,t);return typeof e.docs[n]>"u"?!1:(delete e.docs[n],e.count--,!0)}function co(e){return e.count}function lo(e,t){const n=t;return{docs:n.docs,count:n.count,sharedInternalDocumentStore:e}}function uo(e){return{docs:e.docs,count:e.count}}function fo(){return{create:no,get:oo,getMultiple:ao,getAll:io,store:ro,remove:so,count:co,load:lo,save:uo}}const ho=["beforeInsert","afterInsert","beforeRemove","afterRemove","beforeUpdate","afterUpdate","beforeUpsert","afterUpsert","beforeSearch","afterSearch","beforeInsertMultiple","afterInsertMultiple","beforeRemoveMultiple","afterRemoveMultiple","beforeUpdateMultiple","afterUpdateMultiple","beforeUpsertMultiple","afterUpsertMultiple","beforeLoad","afterLoad","afterCreate"];function go(e,t){const n=[],o=e.plugins?.length;if(!o)return n;for(let a=0;a<o;a++)try{const i=e.plugins[a];typeof i[t]=="function"&&n.push(i[t])}catch(i){throw console.error("Caught error in getAllPluginsByHook:",i),P("PLUGIN_CRASHED")}return n}const bo=["tokenizer","index","documentsStore","sorter"],at=["validateSchema","getDocumentIndexId","getDocumentProperties","formatElapsedTime"];function ze(e,t,n,o,a){if(e.some(de))return(async()=>{for(const r of e)await r(t,n,o,a)})();for(const r of e)r(t,n,o,a)}function Fe(e,t,n,o){if(e.some(de))return(async()=>{for(const i of e)await i(t,n,o)})();for(const i of e)i(t,n,o)}function mo(e,t){if(e.some(de))return(async()=>{for(const o of e)await o(t)})();for(const o of e)o(t)}class U{k;v;l=null;r=null;h=1;constructor(t,n){this.k=t,this.v=new Set(n)}updateHeight(){this.h=Math.max(U.getHeight(this.l),U.getHeight(this.r))+1}static getHeight(t){return t?t.h:0}getBalanceFactor(){return U.getHeight(this.l)-U.getHeight(this.r)}rotateLeft(){const t=this.r;return this.r=t.l,t.l=this,this.updateHeight(),t.updateHeight(),t}rotateRight(){const t=this.l;return this.l=t.r,t.r=this,this.updateHeight(),t.updateHeight(),t}toJSON(){return{k:this.k,v:Array.from(this.v),l:this.l?this.l.toJSON():null,r:this.r?this.r.toJSON():null,h:this.h}}static fromJSON(t){const n=new U(t.k,t.v);return n.l=t.l?U.fromJSON(t.l):null,n.r=t.r?U.fromJSON(t.r):null,n.h=t.h,n}}class fe{root=null;insertCount=0;constructor(t,n){t!==void 0&&n!==void 0&&(this.root=new U(t,n))}insert(t,n,o=1e3){this.root=this.insertNode(this.root,t,n,o)}insertMultiple(t,n,o=1e3){for(const a of n)this.insert(t,a,o)}rebalance(){this.root&&(this.root=this.rebalanceNode(this.root))}toJSON(){return{root:this.root?this.root.toJSON():null,insertCount:this.insertCount}}static fromJSON(t){const n=new fe;return n.root=t.root?U.fromJSON(t.root):null,n.insertCount=t.insertCount||0,n}insertNode(t,n,o,a){if(t===null)return new U(n,[o]);const i=[];let r=t,s=null;for(;r!==null;)if(i.push({parent:s,node:r}),n<r.k)if(r.l===null){r.l=new U(n,[o]),i.push({parent:r,node:r.l});break}else s=r,r=r.l;else if(n>r.k)if(r.r===null){r.r=new U(n,[o]),i.push({parent:r,node:r.r});break}else s=r,r=r.r;else return r.v.add(o),t;let c=!1;this.insertCount++%a===0&&(c=!0);for(let l=i.length-1;l>=0;l--){const{parent:f,node:u}=i[l];if(u.updateHeight(),c){const h=this.rebalanceNode(u);f?f.l===u?f.l=h:f.r===u&&(f.r=h):t=h}}return t}rebalanceNode(t){const n=t.getBalanceFactor();if(n>1){if(t.l&&t.l.getBalanceFactor()>=0)return t.rotateRight();if(t.l)return t.l=t.l.rotateLeft(),t.rotateRight()}if(n<-1){if(t.r&&t.r.getBalanceFactor()<=0)return t.rotateLeft();if(t.r)return t.r=t.r.rotateRight(),t.rotateLeft()}return t}find(t){const n=this.findNodeByKey(t);return n?n.v:null}contains(t){return this.find(t)!==null}getSize(){let t=0;const n=[];let o=this.root;for(;o||n.length>0;){for(;o;)n.push(o),o=o.l;o=n.pop(),t++,o=o.r}return t}isBalanced(){if(!this.root)return!0;const t=[this.root];for(;t.length>0;){const n=t.pop(),o=n.getBalanceFactor();if(Math.abs(o)>1)return!1;n.l&&t.push(n.l),n.r&&t.push(n.r)}return!0}remove(t){this.root=this.removeNode(this.root,t)}removeDocument(t,n){const o=this.findNodeByKey(t);o&&(o.v.size===1?this.root=this.removeNode(this.root,t):o.v=new Set([...o.v.values()].filter(a=>a!==n)))}findNodeByKey(t){let n=this.root;for(;n;)if(t<n.k)n=n.l;else if(t>n.k)n=n.r;else return n;return null}removeNode(t,n){if(t===null)return null;const o=[];let a=t;for(;a!==null&&a.k!==n;)o.push(a),n<a.k?a=a.l:a=a.r;if(a===null)return t;if(a.l===null||a.r===null){const i=a.l?a.l:a.r;if(o.length===0)t=i;else{const r=o[o.length-1];r.l===a?r.l=i:r.r=i}}else{let i=a,r=a.r;for(;r.l!==null;)i=r,r=r.l;a.k=r.k,a.v=r.v,i.l===r?i.l=r.r:i.r=r.r,a=i}o.push(a);for(let i=o.length-1;i>=0;i--){const r=o[i];r.updateHeight();const s=this.rebalanceNode(r);if(i>0){const c=o[i-1];c.l===r?c.l=s:c.r===r&&(c.r=s)}else t=s}return t}rangeSearch(t,n){const o=new Set,a=[];let i=this.root;for(;i||a.length>0;){for(;i;)a.push(i),i=i.l;if(i=a.pop(),i.k>=t&&i.k<=n)for(const r of i.v)o.add(r);if(i.k>n)break;i=i.r}return o}greaterThan(t,n=!1){const o=new Set,a=[];let i=this.root;for(;i||a.length>0;){for(;i;)a.push(i),i=i.r;if(i=a.pop(),n&&i.k>=t||!n&&i.k>t)for(const r of i.v)o.add(r);else if(i.k<=t)break;i=i.l}return o}lessThan(t,n=!1){const o=new Set,a=[];let i=this.root;for(;i||a.length>0;){for(;i;)a.push(i),i=i.l;if(i=a.pop(),n&&i.k<=t||!n&&i.k<t)for(const r of i.v)o.add(r);else if(i.k>t)break;i=i.r}return o}}class he{numberToDocumentId;constructor(){this.numberToDocumentId=new Map}insert(t,n){this.numberToDocumentId.has(t)?this.numberToDocumentId.get(t).add(n):this.numberToDocumentId.set(t,new Set([n]))}find(t){const n=this.numberToDocumentId.get(t);return n?Array.from(n):null}remove(t){this.numberToDocumentId.delete(t)}removeDocument(t,n){const o=this.numberToDocumentId.get(n);o&&(o.delete(t),o.size===0&&this.numberToDocumentId.delete(n))}contains(t){return this.numberToDocumentId.has(t)}getSize(){let t=0;for(const n of this.numberToDocumentId.values())t+=n.size;return t}filter(t){const n=Object.keys(t);if(n.length!==1)throw new Error("Invalid operation");const o=n[0];switch(o){case"eq":{const a=t[o],i=this.numberToDocumentId.get(a);return i?Array.from(i):[]}case"in":{const a=t[o],i=new Set;for(const r of a){const s=this.numberToDocumentId.get(r);if(s)for(const c of s)i.add(c)}return Array.from(i)}case"nin":{const a=new Set(t[o]),i=new Set;for(const[r,s]of this.numberToDocumentId.entries())if(!a.has(r))for(const c of s)i.add(c);return Array.from(i)}default:throw new Error("Invalid operation")}}filterArr(t){const n=Object.keys(t);if(n.length!==1)throw new Error("Invalid operation");const o=n[0];switch(o){case"containsAll":{const i=t[o].map(s=>this.numberToDocumentId.get(s)??new Set);if(i.length===0)return[];const r=i.reduce((s,c)=>new Set([...s].filter(l=>c.has(l))));return Array.from(r)}case"containsAny":{const i=t[o].map(s=>this.numberToDocumentId.get(s)??new Set);if(i.length===0)return[];const r=i.reduce((s,c)=>new Set([...s,...c]));return Array.from(r)}default:throw new Error("Invalid operation")}}static fromJSON(t){if(!t.numberToDocumentId)throw new Error("Invalid Flat Tree JSON");const n=new he;for(const[o,a]of t.numberToDocumentId)n.numberToDocumentId.set(o,new Set(a));return n}toJSON(){return{numberToDocumentId:Array.from(this.numberToDocumentId.entries()).map(([t,n])=>[t,Array.from(n)])}}}function vo(e,t,n){if(n<0)return-1;if(e===t)return 0;const o=e.length,a=t.length;if(o===0)return a<=n?a:-1;if(a===0)return o<=n?o:-1;const i=Math.abs(o-a);if(e.startsWith(t))return i<=n?i:-1;if(t.startsWith(e))return 0;if(i>n)return-1;const r=[];for(let s=0;s<=o;s++){r[s]=[s];for(let c=1;c<=a;c++)r[s][c]=s===0?c:0}for(let s=1;s<=o;s++){let c=1/0;for(let l=1;l<=a;l++)e[s-1]===t[l-1]?r[s][l]=r[s-1][l-1]:r[s][l]=Math.min(r[s-1][l]+1,r[s][l-1]+1,r[s-1][l-1]+1),c=Math.min(c,r[s][l]);if(c>n)return-1}return r[o][a]<=n?r[o][a]:-1}function it(e,t,n){const o=vo(e,t,n);return{distance:o,isBounded:o>=0}}class q{k;s;c=new Map;d=new Set;e;w="";constructor(t,n,o){this.k=t,this.s=n,this.e=o}updateParent(t){this.w=t.w+this.s}addDocument(t){this.d.add(t)}removeDocument(t){return this.d.delete(t)}findAllWords(t,n,o,a){const i=[this];for(;i.length>0;){const r=i.pop();if(r.e){const{w:s,d:c}=r;if(o&&s!==n)continue;if(Ne(t,s)!==null)if(a)if(Math.abs(n.length-s.length)<=a&&it(n,s,a).isBounded)t[s]=[];else continue;else t[s]=[];if(Ne(t,s)!=null&&c.size>0){const l=t[s];for(const f of c)l.includes(f)||l.push(f)}}r.c.size>0&&i.push(...r.c.values())}return t}insert(t,n){let o=this,a=0;const i=t.length;for(;a<i;){const r=t[a],s=o.c.get(r);if(s){const c=s.s,l=c.length;let f=0;for(;f<l&&a+f<i&&c[f]===t[a+f];)f++;if(f===l){if(o=s,a+=f,a===i){s.e||(s.e=!0),s.addDocument(n);return}continue}const u=c.slice(0,f),h=c.slice(f),g=t.slice(a+f),b=new q(u[0],u,!1);if(o.c.set(u[0],b),b.updateParent(o),s.s=h,s.k=h[0],b.c.set(h[0],s),s.updateParent(b),g){const m=new q(g[0],g,!0);m.addDocument(n),b.c.set(g[0],m),m.updateParent(b)}else b.e=!0,b.addDocument(n);return}else{const c=new q(r,t.slice(a),!0);c.addDocument(n),o.c.set(r,c),c.updateParent(o);return}}o.e||(o.e=!0),o.addDocument(n)}_findLevenshtein(t,n,o,a,i){const r=[{node:this,index:n,tolerance:o}];for(;r.length>0;){const{node:s,index:c,tolerance:l}=r.pop();if(s.w.startsWith(t)){s.findAllWords(i,t,!1,0);continue}if(l<0)continue;if(s.e){const{w:u,d:h}=s;if(u&&(it(t,u,a).isBounded&&(i[u]=[]),Ne(i,u)!==void 0&&h.size>0)){const g=new Set(i[u]);for(const b of h)g.add(b);i[u]=Array.from(g)}}if(c>=t.length)continue;const f=t[c];if(s.c.has(f)){const u=s.c.get(f);r.push({node:u,index:c+1,tolerance:l})}r.push({node:s,index:c+1,tolerance:l-1});for(const[u,h]of s.c)r.push({node:h,index:c,tolerance:l-1}),u!==f&&r.push({node:h,index:c+1,tolerance:l-1})}}find(t){const{term:n,exact:o,tolerance:a}=t;if(a&&!o){const i={};return this._findLevenshtein(n,0,a,a,i),i}else{let i=this,r=0;const s=n.length;for(;r<s;){const l=n[r],f=i.c.get(l);if(f){const u=f.s,h=u.length;let g=0;for(;g<h&&r+g<s&&u[g]===n[r+g];)g++;if(g===h)i=f,r+=g;else if(r+g===s)if(g===s-r){if(o)return{};{const b={};return f.findAllWords(b,n,o,a),b}}else return{};else return{}}else return{}}const c={};return i.findAllWords(c,n,o,a),c}}contains(t){let n=this,o=0;const a=t.length;for(;o<a;){const i=t[o],r=n.c.get(i);if(r){const s=r.s,c=s.length;let l=0;for(;l<c&&o+l<a&&s[l]===t[o+l];)l++;if(l<c)return!1;o+=c,n=r}else return!1}return!0}removeWord(t){if(!t)return!1;let n=this;const o=t.length,a=[];for(let i=0;i<o;i++){const r=t[i];if(n.c.has(r)){const s=n.c.get(r);a.push({parent:n,character:r}),i+=s.s.length-1,n=s}else return!1}for(n.d.clear(),n.e=!1;a.length>0&&n.c.size===0&&!n.e&&n.d.size===0;){const{parent:i,character:r}=a.pop();i.c.delete(r),n=i}return!0}removeDocumentByWord(t,n,o=!0){if(!t)return!0;let a=this;const i=t.length;for(let r=0;r<i;r++){const s=t[r];if(a.c.has(s)){const c=a.c.get(s);r+=c.s.length-1,a=c,o&&a.w!==t||a.removeDocument(n)}else return!1}return!0}static getCommonPrefix(t,n){const o=Math.min(t.length,n.length);let a=0;for(;a<o&&t.charCodeAt(a)===n.charCodeAt(a);)a++;return t.slice(0,a)}toJSON(){return{w:this.w,s:this.s,e:this.e,k:this.k,d:Array.from(this.d),c:Array.from(this.c?.entries())?.map(([t,n])=>[t,n.toJSON()])}}static fromJSON(t){const n=new q(t.k,t.s,t.e);return n.w=t.w,n.d=new Set(t.d),n.c=new Map(t?.c?.map(([o,a])=>[o,q.fromJSON(a)])||[]),n}}class ge extends q{constructor(){super("","",!1)}static fromJSON(t){const n=new ge;return n.w=t.w,n.s=t.s,n.e=t.e,n.k=t.k,n.d=new Set(t.d),n.c=new Map(t?.c?.map(([o,a])=>[o,q.fromJSON(a)])||[]),n}toJSON(){return super.toJSON()}}const So=2,yo=6371e3;class X{point;docIDs;left;right;parent;constructor(t,n){this.point=t,this.docIDs=new Set(n),this.left=null,this.right=null,this.parent=null}toJSON(){return{point:this.point,docIDs:Array.from(this.docIDs),left:this.left?this.left.toJSON():null,right:this.right?this.right.toJSON():null}}static fromJSON(t,n=null){const o=new X(t.point,t.docIDs);return o.parent=n,t.left&&(o.left=X.fromJSON(t.left,o)),t.right&&(o.right=X.fromJSON(t.right,o)),o}}class V{root;nodeMap;constructor(){this.root=null,this.nodeMap=new Map}getPointKey(t){return`${t.lon},${t.lat}`}insert(t,n){const o=this.getPointKey(t),a=this.nodeMap.get(o);if(a){n.forEach(c=>a.docIDs.add(c));return}const i=new X(t,n);if(this.nodeMap.set(o,i),this.root==null){this.root=i;return}let r=this.root,s=0;for(;;){if(s%So===0)if(t.lon<r.point.lon){if(r.left==null){r.left=i,i.parent=r;return}r=r.left}else{if(r.right==null){r.right=i,i.parent=r;return}r=r.right}else if(t.lat<r.point.lat){if(r.left==null){r.left=i,i.parent=r;return}r=r.left}else{if(r.right==null){r.right=i,i.parent=r;return}r=r.right}s++}}contains(t){const n=this.getPointKey(t);return this.nodeMap.has(n)}getDocIDsByCoordinates(t){const n=this.getPointKey(t),o=this.nodeMap.get(n);return o?Array.from(o.docIDs):null}removeDocByID(t,n){const o=this.getPointKey(t),a=this.nodeMap.get(o);a&&(a.docIDs.delete(n),a.docIDs.size===0&&(this.nodeMap.delete(o),this.deleteNode(a)))}deleteNode(t){const n=t.parent,o=t.left?t.left:t.right;o&&(o.parent=n),n?n.left===t?n.left=o:n.right===t&&(n.right=o):(this.root=o,this.root&&(this.root.parent=null))}searchByRadius(t,n,o=!0,a="asc",i=!1){const r=i?V.vincentyDistance:V.haversineDistance,s=[{node:this.root,depth:0}],c=[];for(;s.length>0;){const{node:l,depth:f}=s.pop();if(l==null)continue;const u=r(t,l.point);(o?u<=n:u>n)&&c.push({point:l.point,docIDs:Array.from(l.docIDs)}),l.left!=null&&s.push({node:l.left,depth:f+1}),l.right!=null&&s.push({node:l.right,depth:f+1})}return a&&c.sort((l,f)=>{const u=r(t,l.point),h=r(t,f.point);return a.toLowerCase()==="asc"?u-h:h-u}),c}searchByPolygon(t,n=!0,o=null,a=!1){const i=[{node:this.root,depth:0}],r=[];for(;i.length>0;){const{node:c,depth:l}=i.pop();if(c==null)continue;c.left!=null&&i.push({node:c.left,depth:l+1}),c.right!=null&&i.push({node:c.right,depth:l+1});const f=V.isPointInPolygon(t,c.point);(f&&n||!f&&!n)&&r.push({point:c.point,docIDs:Array.from(c.docIDs)})}const s=V.calculatePolygonCentroid(t);if(o){const c=a?V.vincentyDistance:V.haversineDistance;r.sort((l,f)=>{const u=c(s,l.point),h=c(s,f.point);return o.toLowerCase()==="asc"?u-h:h-u})}return r}toJSON(){return{root:this.root?this.root.toJSON():null}}static fromJSON(t){const n=new V;return t.root&&(n.root=X.fromJSON(t.root),n.buildNodeMap(n.root)),n}buildNodeMap(t){if(t==null)return;const n=this.getPointKey(t.point);this.nodeMap.set(n,t),t.left&&this.buildNodeMap(t.left),t.right&&this.buildNodeMap(t.right)}static calculatePolygonCentroid(t){let n=0,o=0,a=0;const i=t.length;for(let s=0,c=i-1;s<i;c=s++){const l=t[s].lon,f=t[s].lat,u=t[c].lon,h=t[c].lat,g=l*h-u*f;n+=g,o+=(l+u)*g,a+=(f+h)*g}n/=2;const r=6*n;return o/=r,a/=r,{lon:o,lat:a}}static isPointInPolygon(t,n){let o=!1;const a=n.lon,i=n.lat,r=t.length;for(let s=0,c=r-1;s<r;c=s++){const l=t[s].lon,f=t[s].lat,u=t[c].lon,h=t[c].lat;f>i!=h>i&&a<(u-l)*(i-f)/(h-f)+l&&(o=!o)}return o}static haversineDistance(t,n){const o=Math.PI/180,a=t.lat*o,i=n.lat*o,r=(n.lat-t.lat)*o,s=(n.lon-t.lon)*o,c=Math.sin(r/2)*Math.sin(r/2)+Math.cos(a)*Math.cos(i)*Math.sin(s/2)*Math.sin(s/2),l=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return yo*l}static vincentyDistance(t,n){const a=.0033528106647474805,i=(1-a)*6378137,r=Math.PI/180,s=t.lat*r,c=n.lat*r,l=(n.lon-t.lon)*r,f=Math.atan((1-a)*Math.tan(s)),u=Math.atan((1-a)*Math.tan(c)),h=Math.sin(f),g=Math.cos(f),b=Math.sin(u),m=Math.cos(u);let I=l,v,S=1e3,E,y,p,T,_,w;do{const L=Math.sin(I),B=Math.cos(I);if(E=Math.sqrt(m*L*(m*L)+(g*b-h*m*B)*(g*b-h*m*B)),E===0)return 0;y=h*b+g*m*B,p=Math.atan2(E,y),T=g*m*L/E,_=1-T*T,w=y-2*h*b/_,isNaN(w)&&(w=0);const Y=a/16*_*(4+a*(4-3*_));v=I,I=l+(1-Y)*a*T*(p+Y*E*(w+Y*y*(-1+2*w*w)))}while(Math.abs(I-v)>1e-12&&--S>0);if(S===0)return NaN;const O=_*(6378137*6378137-i*i)/(i*i),D=1+O/16384*(4096+O*(-768+O*(320-175*O))),R=O/1024*(256+O*(-128+O*(74-47*O))),F=R*E*(w+R/4*(y*(-1+2*w*w)-R/6*w*(-3+4*E*E)*(-3+4*w*w)));return i*D*(p-F)}}class be{true;false;constructor(){this.true=new Set,this.false=new Set}insert(t,n){n?this.true.add(t):this.false.add(t)}delete(t,n){n?this.true.delete(t):this.false.delete(t)}getSize(){return this.true.size+this.false.size}toJSON(){return{true:Array.from(this.true),false:Array.from(this.false)}}static fromJSON(t){const n=new be;return n.true=new Set(t.true),n.false=new Set(t.false),n}}function po(e,t,n,o,a,{k:i,b:r,d:s}){return Math.log(1+(n-t+.5)/(t+.5))*(s+e*(i+1))/(e+i*(1-r+r*o/a))}const Io=.8;class me{size;vectors=new Map;constructor(t){this.size=t}add(t,n){n instanceof Float32Array||(n=new Float32Array(n));const o=Ct(n,this.size);this.vectors.set(t,[o,n])}remove(t){this.vectors.delete(t)}find(t,n,o){return t instanceof Float32Array||(t=new Float32Array(t)),Eo(t,o,this.vectors,this.size,n)}toJSON(){const t=[];for(const[n,[o,a]]of this.vectors)t.push([n,[o,Array.from(a)]]);return{size:this.size,vectors:t}}static fromJSON(t){const n=t,o=new me(n.size);for(const[a,[i,r]]of n.vectors)o.vectors.set(a,[i,new Float32Array(r)]);return o}}function Ct(e,t){let n=0;for(let o=0;o<t;o++)n+=e[o]*e[o];return Math.sqrt(n)}function Eo(e,t,n,o,a){const i=Ct(e,o),r=[],s=t||n.keys();for(const c of s){const l=n.get(c);if(!l)continue;const f=l[0],u=l[1];let h=0;for(let b=0;b<o;b++)h+=e[b]*u[b];const g=h/(i*f);g>=a&&r.push([c,g])}return r}function _o(e,t,n,o,a){const i=W(e.sharedInternalDocumentStore,n);e.avgFieldLength[t]=((e.avgFieldLength[t]??0)*(a-1)+o.length)/a,e.fieldLengths[t][i]=o.length,e.frequencies[t][i]={}}function No(e,t,n,o,a){let i=0;for(const c of o)c===a&&i++;const r=W(e.sharedInternalDocumentStore,n),s=i/o.length;e.frequencies[t][r][a]=s,a in e.tokenOccurrences[t]||(e.tokenOccurrences[t][a]=0),e.tokenOccurrences[t][a]=(e.tokenOccurrences[t][a]??0)+1}function wo(e,t,n,o){const a=W(e.sharedInternalDocumentStore,n);o>1?e.avgFieldLength[t]=(e.avgFieldLength[t]*o-e.fieldLengths[t][a])/(o-1):e.avgFieldLength[t]=void 0,e.fieldLengths[t][a]=void 0,e.frequencies[t][a]=void 0}function To(e,t,n){e.tokenOccurrences[t][n]--}function zt(e,t,n,o,a=""){o||(o={sharedInternalDocumentStore:t,indexes:{},vectorIndexes:{},searchableProperties:[],searchablePropertiesWithTypes:{},frequencies:{},tokenOccurrences:{},avgFieldLength:{},fieldLengths:{}});for(const[i,r]of Object.entries(n)){const s=`${a}${a?".":""}${i}`;if(typeof r=="object"&&!Array.isArray(r)){zt(e,t,r,o,s);continue}if(ne(r))o.searchableProperties.push(s),o.searchablePropertiesWithTypes[s]=r,o.vectorIndexes[s]={type:"Vector",node:new me(Bt(r)),isArray:!1};else{const c=/\[/.test(r);switch(r){case"boolean":case"boolean[]":o.indexes[s]={type:"Bool",node:new be,isArray:c};break;case"number":case"number[]":o.indexes[s]={type:"AVL",node:new fe(0,[]),isArray:c};break;case"string":case"string[]":o.indexes[s]={type:"Radix",node:new ge,isArray:c},o.avgFieldLength[s]=0,o.frequencies[s]={},o.tokenOccurrences[s]={},o.fieldLengths[s]={};break;case"enum":case"enum[]":o.indexes[s]={type:"Flat",node:new he,isArray:c};break;case"geopoint":o.indexes[s]={type:"BKD",node:new V,isArray:c};break;default:throw P("INVALID_SCHEMA_TYPE",Array.isArray(r)?"array":r,s)}o.searchableProperties.push(s),o.searchablePropertiesWithTypes[s]=r}}return o}function Do(e,t,n,o,a,i,r,s){return c=>{const{type:l,node:f}=t.indexes[n];switch(l){case"Bool":{f[c?"true":"false"].add(o);break}case"AVL":{const u=s?.avlRebalanceThreshold??1;f.insert(c,o,u);break}case"Radix":{const u=i.tokenize(c,a,n,!1);e.insertDocumentScoreParameters(t,n,o,u,r);for(const h of u)e.insertTokenScoreParameters(t,n,o,u,h),f.insert(h,o);break}case"Flat":{f.insert(c,o);break}case"BKD":{f.insert(c,[o]);break}}}}function Ao(e,t,n,o,a,i,r,s,c,l,f){if(ne(r))return Po(t,n,i,o,a);const u=Do(e,t,n,a,s,c,l,f);if(!Ce(r))return u(i);const h=i,g=h.length;for(let b=0;b<g;b++)u(h[b])}function Po(e,t,n,o,a){e.vectorIndexes[t].node.add(a,n)}function rt(e,t,n,o,a,i,r,s,c,l){if(ne(r))return t.vectorIndexes[n].node.remove(a),!0;const{type:f,node:u}=t.indexes[n];switch(f){case"AVL":return u.removeDocument(i,a),!0;case"Bool":return u[i?"true":"false"].delete(a),!0;case"Radix":{const h=c.tokenize(i,s,n);e.removeDocumentScoreParameters(t,n,o,l);for(const g of h)e.removeTokenScoreParameters(t,n,g),u.removeDocumentByWord(g,a);return!0}case"Flat":return u.removeDocument(a,i),!0;case"BKD":return u.removeDocByID(i,a),!1}}function Oo(e,t,n,o,a,i,r,s,c,l){if(!Ce(r))return rt(e,t,n,o,a,i,r,s,c,l);const f=Mt(r),u=i,h=u.length;for(let g=0;g<h;g++)rt(e,t,n,o,a,u[g],f,s,c,l);return!0}function Ft(e,t,n,o,a,i,r,s,c,l){const f=Array.from(o),u=e.avgFieldLength[t],h=e.fieldLengths[t],g=e.tokenOccurrences[t],b=e.frequencies[t],m=typeof g[n]=="number"?g[n]??0:0,I=f.length;for(let v=0;v<I;v++){const S=f[v];if(c&&!c.has(S))continue;l.has(S)||l.set(S,new Map);const E=l.get(S);E.set(t,(E.get(t)||0)+1);const y=b?.[S]?.[n]??0,p=po(y,m,a,h[S],u,i);r.has(S)?r.set(S,r.get(S)+p*s):r.set(S,p*s)}}function Ro(e,t,n,o,a,i,r,s,c,l,f,u=0){const h=n.tokenize(t,o),g=h.length||1,b=new Map,m=new Map,I=new Map;for(const E of a){if(!(E in e.indexes))continue;const y=e.indexes[E],{type:p}=y;if(p!=="Radix")throw P("WRONG_SEARCH_PROPERTY_TYPE",E);const T=s[E]??1;if(T<=0)throw P("INVALID_BOOST_VALUE",T);h.length===0&&!t&&h.push("");const _=h.length;for(let w=0;w<_;w++){const O=h[w],D=y.node.find({term:O,exact:i,tolerance:r}),R=Object.keys(D);R.length>0&&m.set(O,!0);const F=R.length;for(let H=0;H<F;H++){const L=R[H],B=D[L];Ft(e,E,L,B,l,c,I,T,f,b)}}}const v=Array.from(I.entries()).map(([E,y])=>[E,y]).sort((E,y)=>y[1]-E[1]);if(v.length===0)return[];if(u===1)return v;if(u===0){if(g===1)return v;for(const y of h)if(!m.get(y))return[];return v.filter(([y])=>{const p=b.get(y);return p?Array.from(p.values()).some(T=>T===g):!1})}const S=v.filter(([E])=>{const y=b.get(E);return y?Array.from(y.values()).some(p=>p===g):!1});if(S.length>0){const E=v.filter(([p])=>!S.some(([T])=>T===p)),y=Math.ceil(E.length*u);return[...S,...E.slice(0,y)]}return v}function re(e,t,n,o){if("and"in n&&n.and&&Array.isArray(n.and)){const r=n.and;if(r.length===0)return new Set;const s=r.map(c=>re(e,t,c,o));return ot(...s)}if("or"in n&&n.or&&Array.isArray(n.or)){const r=n.or;return r.length===0?new Set:r.map(c=>re(e,t,c,o)).reduce((c,l)=>ae(c,l),new Set)}if("not"in n&&n.not){const r=n.not,s=new Set,c=e.sharedInternalDocumentStore;for(let f=1;f<=c.internalIdToId.length;f++)s.add(f);const l=re(e,t,r,o);return Hn(s,l)}const a=Object.keys(n),i=a.reduce((r,s)=>({[s]:new Set,...r}),{});for(const r of a){const s=n[r];if(typeof e.indexes[r]>"u")throw P("UNKNOWN_FILTER_PROPERTY",r);const{node:c,type:l,isArray:f}=e.indexes[r];if(l==="Bool"){const h=c,g=s?h.true:h.false;i[r]=ae(i[r],g);continue}if(l==="BKD"){let h;if("radius"in s)h="radius";else if("polygon"in s)h="polygon";else throw new Error(`Invalid operation ${s}`);if(h==="radius"){const{value:g,coordinates:b,unit:m="m",inside:I=!0,highPrecision:v=!1}=s[h],S=kt(g,m),E=c.searchByRadius(b,S,I,void 0,v);i[r]=st(i[r],E)}else{const{coordinates:g,inside:b=!0,highPrecision:m=!1}=s[h],I=c.searchByPolygon(g,b,void 0,m);i[r]=st(i[r],I)}continue}if(l==="Radix"&&(typeof s=="string"||Array.isArray(s))){for(const h of[s].flat()){const g=t.tokenize(h,o,r);for(const b of g){const m=c.find({term:b,exact:!0});i[r]=Fo(i[r],m)}}continue}const u=Object.keys(s);if(u.length>1)throw P("INVALID_FILTER_OPERATION",u.length);if(l==="Flat"){const h=new Set(f?c.filterArr(s):c.filter(s));i[r]=ae(i[r],h);continue}if(l==="AVL"){const h=u[0],g=s[h];let b;switch(h){case"gt":{b=c.greaterThan(g,!1);break}case"gte":{b=c.greaterThan(g,!0);break}case"lt":{b=c.lessThan(g,!1);break}case"lte":{b=c.lessThan(g,!0);break}case"eq":{b=c.find(g)??new Set;break}case"between":{const[m,I]=g;b=c.rangeSearch(m,I);break}default:throw P("INVALID_FILTER_OPERATION",h)}i[r]=ae(i[r],b)}}return ot(...Object.values(i))}function ko(e){return e.searchableProperties}function Lo(e){return e.searchablePropertiesWithTypes}function xo(e,t){const{indexes:n,vectorIndexes:o,searchableProperties:a,searchablePropertiesWithTypes:i,frequencies:r,tokenOccurrences:s,avgFieldLength:c,fieldLengths:l}=t,f={},u={};for(const h of Object.keys(n)){const{node:g,type:b,isArray:m}=n[h];switch(b){case"Radix":f[h]={type:"Radix",node:ge.fromJSON(g),isArray:m};break;case"Flat":f[h]={type:"Flat",node:he.fromJSON(g),isArray:m};break;case"AVL":f[h]={type:"AVL",node:fe.fromJSON(g),isArray:m};break;case"BKD":f[h]={type:"BKD",node:V.fromJSON(g),isArray:m};break;case"Bool":f[h]={type:"Bool",node:be.fromJSON(g),isArray:m};break;default:f[h]=n[h]}}for(const h of Object.keys(o))u[h]={type:"Vector",isArray:!1,node:me.fromJSON(o[h])};return{sharedInternalDocumentStore:e,indexes:f,vectorIndexes:u,searchableProperties:a,searchablePropertiesWithTypes:i,frequencies:r,tokenOccurrences:s,avgFieldLength:c,fieldLengths:l}}function Mo(e){const{indexes:t,vectorIndexes:n,searchableProperties:o,searchablePropertiesWithTypes:a,frequencies:i,tokenOccurrences:r,avgFieldLength:s,fieldLengths:c}=e,l={};for(const u of Object.keys(n))l[u]=n[u].node.toJSON();const f={};for(const u of Object.keys(t)){const{type:h,node:g,isArray:b}=t[u];h==="Flat"||h==="Radix"||h==="AVL"||h==="BKD"||h==="Bool"?f[u]={type:h,node:g.toJSON(),isArray:b}:(f[u]=t[u],f[u].node=f[u].node.toJSON())}return{indexes:f,vectorIndexes:l,searchableProperties:o,searchablePropertiesWithTypes:a,frequencies:i,tokenOccurrences:r,avgFieldLength:s,fieldLengths:c}}function Bo(){return{create:zt,insert:Ao,remove:Oo,insertDocumentScoreParameters:_o,insertTokenScoreParameters:No,removeDocumentScoreParameters:wo,removeTokenScoreParameters:To,calculateResultScores:Ft,search:Ro,searchByWhereClause:re,getSearchableProperties:ko,getSearchablePropertiesWithTypes:Lo,load:xo,save:Mo}}function st(e,t){e||(e=new Set);const n=t.length;for(let o=0;o<n;o++){const a=t[o].docIDs,i=a.length;for(let r=0;r<i;r++)e.add(a[r])}return e}function ct(e,t,n=!1){const o=n?V.vincentyDistance:V.haversineDistance,a=[],i=[];for(const{point:c}of e)i.push(o(t,c));const r=Math.max(...i);let s=0;for(const{docIDs:c}of e){const l=i[s],f=r-l+1;for(const u of c)a.push([u,f]);s++}return a.sort((c,l)=>l[1]-c[1]),a}function Co(e,t){const n=Object.keys(e);if(n.length!==1)return{isGeoOnly:!1};const o=n[0],a=e[o];if(typeof t.indexes[o]>"u")return{isGeoOnly:!1};const{type:i}=t.indexes[o];return i==="BKD"&&a&&("radius"in a||"polygon"in a)?{isGeoOnly:!0,geoProperty:o,geoOperation:a}:{isGeoOnly:!1}}function zo(e,t){const n=e,o=Co(t,n);if(!o.isGeoOnly||!o.geoProperty||!o.geoOperation)return null;const{node:a}=n.indexes[o.geoProperty],i=o.geoOperation,r=a;let s;if("radius"in i){const{value:c,coordinates:l,unit:f="m",inside:u=!0,highPrecision:h=!1}=i.radius,g=l,b=kt(c,f);return s=r.searchByRadius(g,b,u,"asc",h),ct(s,g,h)}else if("polygon"in i){const{coordinates:c,inside:l=!0,highPrecision:f=!1}=i.polygon;s=r.searchByPolygon(c,l,"asc",f);const u=V.calculatePolygonCentroid(c);return ct(s,u,f)}return null}function Fo(e,t){e||(e=new Set);const n=Object.keys(t),o=n.length;for(let a=0;a<o;a++){const i=t[n[a]],r=i.length;for(let s=0;s<r;s++)e.add(i[s])}return e}function Ut(e,t,n,o,a){const i={language:e.tokenizer.language,sharedInternalDocumentStore:t,enabled:!0,isSorted:!0,sortableProperties:[],sortablePropertiesWithTypes:{},sorts:{}};for(const[r,s]of Object.entries(n)){const c=`${a}${a?".":""}${r}`;if(!o.includes(c)){if(typeof s=="object"&&!Array.isArray(s)){const l=Ut(e,t,s,o,c);At(i.sortableProperties,l.sortableProperties),i.sorts={...i.sorts,...l.sorts},i.sortablePropertiesWithTypes={...i.sortablePropertiesWithTypes,...l.sortablePropertiesWithTypes};continue}if(!ne(s))switch(s){case"boolean":case"number":case"string":i.sortableProperties.push(c),i.sortablePropertiesWithTypes[c]=s,i.sorts[c]={docs:new Map,orderedDocsToRemove:new Map,orderedDocs:[],type:s};break;case"geopoint":case"enum":continue;case"enum[]":case"boolean[]":case"number[]":case"string[]":continue;default:throw P("INVALID_SORT_SCHEMA_TYPE",Array.isArray(s)?"array":s,c)}}}return i}function Uo(e,t,n,o){return o?.enabled!==!1?Ut(e,t,n,(o||{}).unsortableProperties||[],""):{disabled:!0}}function Vo(e,t,n,o){if(!e.enabled)return;e.isSorted=!1;const a=W(e.sharedInternalDocumentStore,n),i=e.sorts[t];i.orderedDocsToRemove.has(a)&&Ue(e,t),i.docs.set(a,i.orderedDocs.length),i.orderedDocs.push([a,o])}function Vt(e){if(e.isSorted||!e.enabled)return;const t=Object.keys(e.sorts);for(const n of t)Go(e,n);e.isSorted=!0}function $o(e,t,n){return t[1].localeCompare(n[1],Cn(e))}function Wo(e,t){return e[1]-t[1]}function jo(e,t){return t[1]?-1:1}function Go(e,t){const n=e.sorts[t];let o;switch(n.type){case"string":o=$o.bind(null,e.language);break;case"number":o=Wo.bind(null);break;case"boolean":o=jo.bind(null);break}n.orderedDocs.sort(o);const a=n.orderedDocs.length;for(let i=0;i<a;i++){const r=n.orderedDocs[i][0];n.docs.set(r,i)}}function Ho(e){const t=Object.keys(e.sorts);for(const n of t)Ue(e,n)}function Ue(e,t){const n=e.sorts[t];n.orderedDocsToRemove.size&&(n.orderedDocs=n.orderedDocs.filter(o=>!n.orderedDocsToRemove.has(o[0])),n.orderedDocsToRemove.clear())}function Yo(e,t,n){if(!e.enabled)return;const o=e.sorts[t],a=W(e.sharedInternalDocumentStore,n);o.docs.get(a)&&(o.docs.delete(a),o.orderedDocsToRemove.set(a,!0))}function qo(e,t,n){if(!e.enabled)throw P("SORT_DISABLED");const o=n.property,a=n.order==="DESC",i=e.sorts[o];if(!i)throw P("UNABLE_TO_SORT_ON_UNKNOWN_FIELD",o,e.sortableProperties.join(", "));return Ue(e,o),Vt(e),t.sort((r,s)=>{const c=i.docs.get(W(e.sharedInternalDocumentStore,r[0])),l=i.docs.get(W(e.sharedInternalDocumentStore,s[0])),f=typeof c<"u",u=typeof l<"u";return!f&&!u?0:f?u?a?l-c:c-l:-1:1}),t}function Jo(e){return e.enabled?e.sortableProperties:[]}function Ko(e){return e.enabled?e.sortablePropertiesWithTypes:{}}function Xo(e,t){const n=t;if(!n.enabled)return{enabled:!1};const o=Object.keys(n.sorts).reduce((a,i)=>{const{docs:r,orderedDocs:s,type:c}=n.sorts[i];return a[i]={docs:new Map(Object.entries(r).map(([l,f])=>[+l,f])),orderedDocsToRemove:new Map,orderedDocs:s,type:c},a},{});return{sharedInternalDocumentStore:e,language:n.language,sortableProperties:n.sortableProperties,sortablePropertiesWithTypes:n.sortablePropertiesWithTypes,sorts:o,enabled:!0,isSorted:n.isSorted}}function Zo(e){if(!e.enabled)return{enabled:!1};Ho(e),Vt(e);const t=Object.keys(e.sorts).reduce((n,o)=>{const{docs:a,orderedDocs:i,type:r}=e.sorts[o];return n[o]={docs:Object.fromEntries(a.entries()),orderedDocs:i,type:r},n},{});return{language:e.language,sortableProperties:e.sortableProperties,sortablePropertiesWithTypes:e.sortablePropertiesWithTypes,sorts:t,enabled:e.enabled,isSorted:e.isSorted}}function Qo(){return{create:Uo,insert:Vo,remove:Yo,save:Zo,load:Xo,sortBy:qo,getSortableProperties:Jo,getSortablePropertiesWithTypes:Ko}}const lt=192,ea=383,ta=[65,65,65,65,65,65,65,67,69,69,69,69,73,73,73,73,69,78,79,79,79,79,79,null,79,85,85,85,85,89,80,115,97,97,97,97,97,97,97,99,101,101,101,101,105,105,105,105,101,110,111,111,111,111,111,null,111,117,117,117,117,121,112,121,65,97,65,97,65,97,67,99,67,99,67,99,67,99,68,100,68,100,69,101,69,101,69,101,69,101,69,101,71,103,71,103,71,103,71,103,72,104,72,104,73,105,73,105,73,105,73,105,73,105,73,105,74,106,75,107,107,76,108,76,108,76,108,76,108,76,108,78,110,78,110,78,110,110,78,110,79,111,79,111,79,111,79,111,82,114,82,114,82,114,83,115,83,115,83,115,83,115,84,116,84,116,84,116,85,117,85,117,85,117,85,117,85,117,85,117,87,119,89,121,89,90,122,90,122,90,122,115];function na(e){return e<lt||e>ea?e:ta[e-lt]||e}function oa(e){const t=[];for(let n=0;n<e.length;n++)t[n]=na(e.charCodeAt(n));return String.fromCharCode(...t)}const aa={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},ia={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},ra="[^aeiou]",ce="[aeiouy]",G=ra+"[^aeiouy]*",te=ce+"[aeiou]*",we="^("+G+")?"+te+G,sa="^("+G+")?"+te+G+"("+te+")?$",ie="^("+G+")?"+te+G+te+G,dt="^("+G+")?"+ce;function ca(e){let t,n,o,a,i,r;if(e.length<3)return e;const s=e.substring(0,1);if(s=="y"&&(e=s.toUpperCase()+e.substring(1)),o=/^(.+?)(ss|i)es$/,a=/^(.+?)([^s])s$/,o.test(e)?e=e.replace(o,"$1$2"):a.test(e)&&(e=e.replace(a,"$1$2")),o=/^(.+?)eed$/,a=/^(.+?)(ed|ing)$/,o.test(e)){const c=o.exec(e);o=new RegExp(we),o.test(c[1])&&(o=/.$/,e=e.replace(o,""))}else a.test(e)&&(t=a.exec(e)[1],a=new RegExp(dt),a.test(t)&&(e=t,a=/(at|bl|iz)$/,i=new RegExp("([^aeiouylsz])\\1$"),r=new RegExp("^"+G+ce+"[^aeiouwxy]$"),a.test(e)?e=e+"e":i.test(e)?(o=/.$/,e=e.replace(o,"")):r.test(e)&&(e=e+"e")));if(o=/^(.+?)y$/,o.test(e)&&(t=o.exec(e)?.[1],o=new RegExp(dt),t&&o.test(t)&&(e=t+"i")),o=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,o.test(e)){const c=o.exec(e);t=c?.[1],n=c?.[2],o=new RegExp(we),t&&o.test(t)&&(e=t+aa[n])}if(o=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,o.test(e)){const c=o.exec(e);t=c?.[1],n=c?.[2],o=new RegExp(we),t&&o.test(t)&&(e=t+ia[n])}if(o=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,a=/^(.+?)(s|t)(ion)$/,o.test(e))t=o.exec(e)?.[1],o=new RegExp(ie),t&&o.test(t)&&(e=t);else if(a.test(e)){const c=a.exec(e);t=c?.[1]??""+c?.[2]??"",a=new RegExp(ie),a.test(t)&&(e=t)}return o=/^(.+?)e$/,o.test(e)&&(t=o.exec(e)?.[1],o=new RegExp(ie),a=new RegExp(sa),i=new RegExp("^"+G+ce+"[^aeiouwxy]$"),t&&(o.test(t)||a.test(t)&&!i.test(t))&&(e=t)),o=/ll$/,a=new RegExp(ie),o.test(e)&&a.test(e)&&(o=/.$/,e=e.replace(o,"")),s=="y"&&(e=s.toLowerCase()+e.substring(1)),e}function ut(e,t,n=!0){const o=`${this.language}:${e}:${t}`;return n&&this.normalizationCache.has(o)?this.normalizationCache.get(o):this.stopWords?.includes(t)?(n&&this.normalizationCache.set(o,""),""):(this.stemmer&&!this.stemmerSkipProperties.has(e)&&(t=this.stemmer(t)),t=oa(t),n&&this.normalizationCache.set(o,t),t)}function la(e){for(;e[e.length-1]==="";)e.pop();for(;e[0]==="";)e.shift();return e}function ft(e,t,n,o=!0){if(t&&t!==this.language)throw P("LANGUAGE_NOT_SUPPORTED",t);if(typeof e!="string")return[e];const a=this.normalizeToken.bind(this,n??"");let i;if(n&&this.tokenizeSkipProperties.has(n))i=[a(e,o)];else{const s=Bn[this.language];i=e.toLowerCase().split(s).map(c=>a(c,o)).filter(Boolean)}const r=la(i);return this.allowDuplicates?r:Array.from(new Set(r))}function ht(e={}){if(!e.language)e.language="english";else if(!xe.includes(e.language))throw P("LANGUAGE_NOT_SUPPORTED",e.language);let t;if(e.stemming||e.stemmer&&!("stemming"in e))if(e.stemmer){if(typeof e.stemmer!="function")throw P("INVALID_STEMMER_FUNCTION_TYPE");t=e.stemmer}else if(e.language==="english")t=ca;else throw P("MISSING_STEMMER",e.language);let n;if(e.stopWords!==!1){if(n=[],Array.isArray(e.stopWords))n=e.stopWords;else if(typeof e.stopWords=="function")n=e.stopWords(n);else if(e.stopWords)throw P("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");if(!Array.isArray(n))throw P("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");for(const a of n)if(typeof a!="string")throw P("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY")}const o={tokenize:ft,language:e.language,stemmer:t,stemmerSkipProperties:new Set(e.stemmerSkipProperties?[e.stemmerSkipProperties].flat():[]),tokenizeSkipProperties:new Set(e.tokenizeSkipProperties?[e.tokenizeSkipProperties].flat():[]),stopWords:n,allowDuplicates:!!e.allowDuplicates,normalizeToken:ut,normalizationCache:new Map};return o.tokenize=ft.bind(o),o.normalizeToken=ut,o}function da(e){const t={formatElapsedTime:Jn,getDocumentIndexId:Kn,getDocumentProperties:Rt,validateSchema:xt};for(const n of at){const o=n;if(e[o]){if(typeof e[o]!="function")throw P("COMPONENT_MUST_BE_FUNCTION",o)}else e[o]=t[o]}for(const n of Object.keys(e))if(!bo.includes(n)&&!at.includes(n))throw P("UNSUPPORTED_COMPONENT",n)}function ua({schema:e,sort:t,language:n,components:o,id:a,plugins:i}){o||(o={});for(const v of i??[]){if(!("getComponents"in v)||typeof v.getComponents!="function")continue;const S=v.getComponents(e),E=Object.keys(S);for(const y of E)if(o[y])throw P("PLUGIN_COMPONENT_CONFLICT",y,v.name);o={...o,...S}}a||(a=Pt());let r=o.tokenizer,s=o.index,c=o.documentsStore,l=o.sorter;if(r?r.tokenize?r=r:r=ht(r):r=ht({language:n??"english"}),o.tokenizer&&n)throw P("NO_LANGUAGE_WITH_CUSTOM_TOKENIZER");const f=Qn();s||=Bo(),l||=Qo(),c||=fo(),da(o);const{getDocumentProperties:u,getDocumentIndexId:h,validateSchema:g,formatElapsedTime:b}=o,m={data:{},caches:{},schema:e,tokenizer:r,index:s,sorter:l,documentsStore:c,internalDocumentIDStore:f,getDocumentProperties:u,getDocumentIndexId:h,validateSchema:g,beforeInsert:[],afterInsert:[],beforeRemove:[],afterRemove:[],beforeUpdate:[],afterUpdate:[],beforeUpsert:[],afterUpsert:[],beforeSearch:[],afterSearch:[],beforeInsertMultiple:[],afterInsertMultiple:[],beforeRemoveMultiple:[],afterRemoveMultiple:[],beforeUpdateMultiple:[],afterUpdateMultiple:[],beforeUpsertMultiple:[],afterUpsertMultiple:[],afterCreate:[],formatElapsedTime:b,id:a,plugins:i,version:fa()};m.data={index:m.index.create(m,f,e),docs:m.documentsStore.create(m,f),sorting:m.sorter.create(m,f,e,t)};for(const v of ho)m[v]=(m[v]??[]).concat(go(m,v));const I=m.afterCreate;return I&&mo(I,m),m}function fa(){return"{{VERSION}}"}function ha(e){return e.documentsStore.count(e.data.docs)}const gt="fulltext",ga="hybrid",ba="vector";function ma(e,t){return e[1]-t[1]}function va(e,t){return t[1]-e[1]}function Sa(e="desc"){return e.toLowerCase()==="asc"?ma:va}function Ve(e,t,n){const o={},a=t.map(([l])=>l),i=e.documentsStore.getMultiple(e.data.docs,a),r=Object.keys(n),s=e.index.getSearchablePropertiesWithTypes(e.data.index);for(const l of r){let f;if(s[l]==="number"){const{ranges:u}=n[l],h=u.length,g=Array.from({length:h});for(let b=0;b<h;b++){const m=u[b];g[b]=[`${m.from}-${m.to}`,0]}f=Object.fromEntries(g)}o[l]={count:0,values:f??{}}}const c=i.length;for(let l=0;l<c;l++){const f=i[l];for(const u of r){const h=u.includes(".")?Be(f,u):f[u],g=s[u],b=o[u].values;switch(g){case"number":{const m=n[u].ranges;bt(m,b)(h);break}case"number[]":{const m=new Set,I=n[u].ranges,v=bt(I,b,m);for(const S of h)v(S);break}case"boolean":case"enum":case"string":{mt(b,g)(h);break}case"boolean[]":case"enum[]":case"string[]":{const v=mt(b,g==="boolean[]"?"boolean":"string",new Set);for(const S of h)v(S);break}default:throw P("FACET_NOT_SUPPORTED",g)}}}for(const l of r){const f=o[l];if(f.count=Object.keys(f.values).length,s[l]==="string"){const u=n[l],h=Sa(u.sort);f.values=Object.fromEntries(Object.entries(f.values).sort(h).slice(u.offset??0,u.limit??10))}}return o}function bt(e,t,n){return o=>{for(const a of e){const i=`${a.from}-${a.to}`;n?.has(i)||o>=a.from&&o<=a.to&&(t[i]===void 0?t[i]=1:(t[i]++,n?.add(i)))}}}function mt(e,t,n){const o=t==="boolean"?"false":"";return a=>{const i=a?.toString()??o;n?.has(i)||(e[i]=(e[i]??0)+1,n?.add(i))}}const ya={reducer:(e,t,n,o)=>(t[o]=n,t),getInitialValue:e=>Array.from({length:e})},vt=["string","number","boolean"];function $e(e,t,n){const o=n.properties,a=o.length,i=e.index.getSearchablePropertiesWithTypes(e.data.index);for(let v=0;v<a;v++){const S=o[v];if(typeof i[S]>"u")throw P("UNKNOWN_GROUP_BY_PROPERTY",S);if(!vt.includes(i[S]))throw P("INVALID_GROUP_BY_PROPERTY",S,vt.join(", "),i[S])}const r=t.map(([v])=>ue(e.internalDocumentIDStore,v)),s=e.documentsStore.getMultiple(e.data.docs,r),c=s.length,l=n.maxResult||Number.MAX_SAFE_INTEGER,f=[],u={};for(let v=0;v<a;v++){const S=o[v],E={property:S,perValue:{}},y=new Set;for(let p=0;p<c;p++){const T=s[p],_=Be(T,S);if(typeof _>"u")continue;const w=typeof _!="boolean"?_:""+_,O=E.perValue[w]??{indexes:[],count:0};O.count>=l||(O.indexes.push(p),O.count++,E.perValue[w]=O,y.add(_))}f.push(Array.from(y)),u[S]=E}const h=$t(f),g=h.length,b=[];for(let v=0;v<g;v++){const S=h[v],E=S.length,y={values:[],indexes:[]},p=[];for(let T=0;T<E;T++){const _=S[T],w=o[T];p.push(u[w].perValue[typeof _!="boolean"?_:""+_].indexes),y.values.push(_)}y.indexes=Wn(p).sort((T,_)=>T-_),y.indexes.length!==0&&b.push(y)}const m=b.length,I=Array.from({length:m});for(let v=0;v<m;v++){const S=b[v],E=n.reduce||ya,y=S.indexes.map(w=>({id:r[w],score:t[w][1],document:s[w]})),p=E.reducer.bind(null,S.values),T=E.getInitialValue(S.indexes.length),_=y.reduce(p,T);I[v]={values:S.values,result:_}}return I}function $t(e,t=0){if(t+1===e.length)return e[t].map(i=>[i]);const n=e[t],o=$t(e,t+1),a=[];for(const i of n)for(const r of o){const s=[i];At(s,r),a.push(s)}return a}function Wt(e,t,n){const{term:o,properties:a}=t,i=e.data.index;let r=e.caches.propertiesToSearch;if(!r){const u=e.index.getSearchablePropertiesWithTypes(i);r=e.index.getSearchableProperties(i),r=r.filter(h=>u[h].startsWith("string")),e.caches.propertiesToSearch=r}if(a&&a!=="*"){for(const u of a)if(!r.includes(u))throw P("UNKNOWN_INDEX",u,r.join(", "));r=r.filter(u=>a.includes(u))}const s=Object.keys(t.where??{}).length>0;let c;s&&(c=e.index.searchByWhereClause(i,e.tokenizer,t.where,n));let l;const f=t.threshold!==void 0&&t.threshold!==null?t.threshold:1;if(o||a){const u=ha(e);l=e.index.search(i,o||"",e.tokenizer,n,r,t.exact||!1,t.tolerance||0,t.boost||{},Ia(t.relevance),u,c,f)}else if(s){const u=zo(i,t.where);u?l=u:l=(c?Array.from(c):[]).map(g=>[+g,0])}else l=Object.keys(e.documentsStore.getAll(e.data.docs)).map(h=>[+h,0]);return l}function pa(e,t,n){const o=Z();function a(){const s=Object.keys(e.data.index.vectorIndexes),c=t.facets&&Object.keys(t.facets).length>0,{limit:l=10,offset:f=0,distinctOn:u,includeVectors:h=!1}=t,g=t.preflight===!0;let b=Wt(e,t,n);if(t.sortBy)if(typeof t.sortBy=="function"){const v=b.map(([y])=>y),E=e.documentsStore.getMultiple(e.data.docs,v).map((y,p)=>[b[p][0],b[p][1],y]);E.sort(t.sortBy),b=E.map(([y,p])=>[y,p])}else b=e.sorter.sortBy(e.data.sorting,b,t.sortBy).map(([v,S])=>[W(e.internalDocumentIDStore,v),S]);else b=b.sort(Ot);let m;g||(m=u?Oa(e,b,f,l,u):Gt(e,b,f,l));const I={elapsed:{formatted:"",raw:0},hits:[],count:b.length};if(typeof m<"u"&&(I.hits=m.filter(Boolean),h||Lt(I,s)),c){const v=Ve(e,b,t.facets);I.facets=v}return t.groupBy&&(I.groups=$e(e,b,t.groupBy)),I.elapsed=e.formatElapsedTime(Z()-o),I}async function i(){e.beforeSearch&&await Fe(e.beforeSearch,e,t,n);const s=a();return e.afterSearch&&await ze(e.afterSearch,e,t,n,s),s}return e.beforeSearch?.length||e.afterSearch?.length?i():a()}const Te={k:1.2,b:.75,d:.5};function Ia(e){const t=e??{};return t.k=t.k??Te.k,t.b=t.b??Te.b,t.d=t.d??Te.d,t}function jt(e,t,n){const o=t.vector;if(o&&(!("value"in o)||!("property"in o)))throw P("INVALID_VECTOR_INPUT",Object.keys(o).join(", "));const a=e.data.index.vectorIndexes[o.property];if(!a)throw P("UNKNOWN_VECTOR_PROPERTY",o.property);const i=a.node.size;if(o?.value.length!==i)throw o?.property===void 0||o?.value.length===void 0?P("INVALID_INPUT_VECTOR","undefined",i,"undefined"):P("INVALID_INPUT_VECTOR",o.property,i,o.value.length);const r=e.data.index;let s;return Object.keys(t.where??{}).length>0&&(s=e.index.searchByWhereClause(r,e.tokenizer,t.where,n)),a.node.find(o.value,t.similarity??Io,s)}function Ea(e,t,n="english"){const o=Z();function a(){const s=jt(e,t,n).sort(Ot);let c=[];t.facets&&Object.keys(t.facets).length>0&&(c=Ve(e,s,t.facets));const f=t.vector.property,u=t.includeVectors??!1,h=t.limit??10,g=t.offset??0,b=Array.from({length:h});for(let S=0;S<h;S++){const E=s[S+g];if(!E)break;const y=e.data.docs.docs[E[0]];if(y){u||(y[f]=null);const p={id:ue(e.internalDocumentIDStore,E[0]),score:E[1],document:y};b[S]=p}}let m=[];t.groupBy&&(m=$e(e,s,t.groupBy));const v=Z()-o;return{count:s.length,hits:b.filter(Boolean),elapsed:{raw:Number(v),formatted:Me(v)},...c?{facets:c}:{},...m?{groups:m}:{}}}async function i(){e.beforeSearch&&await Fe(e.beforeSearch,e,t,n);const s=a();return e.afterSearch&&await ze(e.afterSearch,e,t,n,s),s}return e.beforeSearch?.length||e.afterSearch?.length?i():a()}function _a(e,t,n){const o=wa(Wt(e,t,n)),a=jt(e,t,n),i=t.hybridWeights;return Da(o,a,t.term??"",i)}function Na(e,t,n){const o=Z();function a(){const s=_a(e,t,n);let c;t.facets&&Object.keys(t.facets).length>0&&(c=Ve(e,s,t.facets));let f;t.groupBy&&(f=$e(e,s,t.groupBy));const u=t.offset??0,h=t.limit??10,g=Gt(e,s,u,h).filter(Boolean),b=Z(),m={count:s.length,elapsed:{raw:Number(b-o),formatted:Me(b-o)},hits:g,...c?{facets:c}:{},...f?{groups:f}:{}};if(!(t.includeVectors??!1)){const v=Object.keys(e.data.index.vectorIndexes);Lt(m,v)}return m}async function i(){e.beforeSearch&&await Fe(e.beforeSearch,e,t,n);const s=a();return e.afterSearch&&await ze(e.afterSearch,e,t,n,s),s}return e.beforeSearch?.length||e.afterSearch?.length?i():a()}function Le(e){return e[1]}function wa(e){const t=Math.max.apply(Math,e.map(Le));return e.map(([n,o])=>[n,o/t])}function St(e,t){return e/t}function Ta(e,t){return(n,o)=>n*e+o*t}function Da(e,t,n,o){const a=Math.max.apply(Math,e.map(Le)),i=Math.max.apply(Math,t.map(Le)),r=o&&o.text&&o.vector,{text:s,vector:c}=r?o:Aa(),l=new Map,f=e.length,u=Ta(s,c);for(let g=0;g<f;g++){const[b,m]=e[g],I=St(m,a),v=u(I,0);l.set(b,v)}const h=t.length;for(let g=0;g<h;g++){const[b,m]=t[g],I=St(m,i),v=l.get(b)??0;l.set(b,v+u(0,I))}return[...l].sort((g,b)=>b[1]-g[1])}function Aa(e){return{text:.5,vector:.5}}function Pa(e,t,n){const o=t.mode??gt;if(o===gt)return pa(e,t,n);if(o===ba)return Ea(e,t);if(o===ga)return Na(e,t);throw P("INVALID_SEARCH_MODE",o)}function Oa(e,t,n,o,a){const i=e.data.docs,r=new Map,s=[],c=new Set,l=t.length;let f=0;for(let u=0;u<l;u++){const h=t[u];if(typeof h>"u")continue;const[g,b]=h;if(c.has(g))continue;const m=e.documentsStore.get(i,g),I=Be(m,a);if(!(typeof I>"u"||r.has(I))&&(r.set(I,!0),f++,!(f<=n)&&(s.push({id:ue(e.internalDocumentIDStore,g),score:b,document:m}),c.add(g),f>=n+o)))break}return s}function Gt(e,t,n,o){const a=e.data.docs,i=Array.from({length:o}),r=new Set;for(let s=n;s<o+n;s++){const c=t[s];if(typeof c>"u")break;const[l,f]=c;if(!r.has(l)){const u=e.documentsStore.get(a,l);i[s]={id:ue(e.internalDocumentIDStore,l),score:f,document:u},r.add(l)}}return i}function Ra(e,t){e.internalDocumentIDStore.load(e,t.internalDocumentIDStore),e.data.index=e.index.load(e.internalDocumentIDStore,t.index),e.data.docs=e.documentsStore.load(e.internalDocumentIDStore,t.docs),e.data.sorting=e.sorter.load(e.internalDocumentIDStore,t.sorting),e.tokenizer.language=t.language}function ka(e,t){const[n,o]=d.useState(e);return d.useEffect(()=>{const a=setTimeout(()=>{o(e)},t);return()=>{clearTimeout(a)}},[e,t]),n}function La(){const[e,t]=d.useState(!1),[n,o]=d.useState(),[a,i]=d.useState(),[r,s]=d.useState(""),c=ka(r,200);return d.useEffect(()=>{(async()=>{const f=ua({schema:{_:"string"}}),u=await fetch("/one-platform/assets/oramaDB_pages.json");if(u.ok){const h=await u.json();Ra(f,h),o(f)}})()},[]),d.useEffect(()=>{if(n&&c){const l=Pa(n,{term:c});i(l)}},[c,n]),A.jsxs("div",{className:"dba-search",children:[A.jsxs(K,{icon:"magnifying_glass",noText:!0,variant:"ghost",onClick:()=>t(!0),children:["Open Search",A.jsx(le,{placement:"left",children:"Open Search"})]}),A.jsx(wt,{open:e,onClose:()=>t(!1),children:A.jsxs("div",{className:"dba-search-result-container",children:[A.jsx(Dn,{label:"Search",placeholder:"Search",icon:"magnifying_glass",variant:"floating",onChange:l=>s(l.target.value)}),(a?.hits?.length||0)>0?a?.hits.map(l=>{const f=l.document.content.replace(l.document.h1,""),{start:u,termIndex:h,end:g}=Ht(f,r);return A.jsx("a",{href:`/one-platform/${l.document.path.replace("/","")}`,children:A.jsxs(ln,{children:[A.jsx("span",{className:"bold",children:l.document.h1}),A.jsxs("small",{children:[f.substring(u,h),A.jsx("mark",{children:f.substring(h,h+r.length)}),f.substring(h+r.length,g)]})]})},l.document.path)}):A.jsx("p",{className:"no-results",children:"No results found"})]})})]})}const yt=()=>A.jsxs(wn,{children:[A.jsx(La,{}),A.jsx("a",{className:"db-button",href:`${se.basePath}resources/documentation/getting-started`,"data-variant":"brand",children:"Start now"})]});function xa(e){const{basePath:t}=se,n=window.location.pathname.replace(/\/+$/,""),o=`${t}${e}`.replace(/\/+$/,"");return n===o?"page":void 0}const We=({path:e,title:t,icon:n,iconTrailing:o,children:a,isSubNavigation:i})=>{if(i){const r=e??Jt(a),s=typeof window<"u"&&Kt({path:e,children:a},window.location.pathname);return A.jsx(Xe,{icon:n,children:A.jsx("a",{href:r,"aria-current":s?"page":void 0,"data-icon-trailing":o,children:t})},`router-leaf-${r??t}`)}return a&&a.length>0?A.jsx(Rn,{text:t,children:a.map(r=>A.jsx(We,{...r},`router-sub-${r.path??r.title}`))},`router-group-${e??t}`):A.jsx(Xe,{icon:n,children:A.jsx("a",{href:e,"aria-current":xa(e),"data-icon-trailing":o,children:t})},`router-leaf-${e??t}`)},pt=({mobile:e})=>A.jsx(Tt,{variant:e?"tree":"popover","aria-label":"main navigation",children:Xt.map(t=>A.jsx(We,{...t},`router-${t.path}-${t.title}`))}),Ma=({navigationItems:e})=>A.jsx(Mn,{children:A.jsx(Tt,{"aria-label":"sub navigation",children:e.map(t=>A.jsx(We,{...t},`sub-navigation-${t.path}-${t.path}`))})}),It=()=>A.jsx(fn,{icon:"brand",children:A.jsx("a",{href:se.basePath,children:se.title})});function Ua({children:e}){const t=Zt(window.location.pathname);return A.jsx(Ln,{fadeIn:!0,subNavigationDesktopPosition:"left",subNavigation:t?A.jsx(Ma,{navigationItems:t}):null,subNavigationMobilePosition:"none",controlPanelDesktop:A.jsx(pn,{brand:A.jsx(It,{}),primaryActions:A.jsx(yt,{}),children:A.jsx(pt,{})}),controlPanelMobile:A.jsx(_n,{brand:A.jsx(It,{}),primaryActions:A.jsx(yt,{}),children:A.jsx(pt,{mobile:!0})}),children:e})}export{Ua as Shell};
